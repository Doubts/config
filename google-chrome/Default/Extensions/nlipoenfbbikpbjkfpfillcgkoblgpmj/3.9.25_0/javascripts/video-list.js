function getList(a){return new Promise(function(b,c){$.ajax({type:"GET",url:"https://preview.diigo.com/api/v3/awe/upload/?user_id="+a,dataType:"json",success:function(a){b(a)},error:function(a,b){c([a,b])}})})}function initList(){DB.init().then(DB.getAll.bind(DB)).then(function(a){console.log(a),buildList(a)}),$("#delete-all").on("click",function(a){a.preventDefault();var b=confirm("Are you sure to delete all the recordings?");b&&DB.deleteAll().then(updateList)})}function updateList(){DB.getAll().then(buildList)}function buildList(a){var b=$("#video-container");if(b.empty(),a.length){var c=$("#video-item-template").html();a.forEach(function(a){var d=a.detail,e=$(c);e.find("a").attr("href",chrome.extension.getURL("/video.html?id="+a.id)),e.find(".thumbnail-img").attr("src",d.thumbnailUrl),e.find(".title").text(d.title).attr("title",d.title),e.find(".duration").text(d.duration),e.find(".size").text(d.size),e.attr("data-id",a.id),e.find(".delete-icon").on("click",function(){var b=confirm("Are you sure to delete this recording?");b&&DB.delete(a.id).then(updateList)}),d.youtubeUrl&&e.addClass("shared_youtube"),d.gDriveUrl&&e.addClass("shared_gDrive"),e.appendTo(b)})}}var youtube_prefix="ba9b_",google_prefix="c822_";initList();