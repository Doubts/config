function getCamera(a){window.navigator.webkitGetUserMedia({video:{optional:[{echoCancellation:!1}]}},function(b){a(b)},function(){})}var recorder=null;chrome.runtime.onMessage.addListener(function(a){"stop"==a.name&&recorder.stream.stop()}),getCamera(function(a){var b={type:"video",disableLogs:!1,recorderType:MediaStreamRecorder};recorder=RecordRTC(a,b),recorder.stream=a,recorder.stream.onended=function(){recorder&&recorder.stream&&(recorder.stream.onended=function(){}),recorder.stopRecording(function(){var a=new File([recorder.getBlob()],"AwesomeScreenshot-"+(new Date).toISOString().replace(/:|\./g,"-")+"camera.webm",{type:"video/webm"});console.log(a);URL.createObjectURL(recorder.getBlob());fileSaver.save(recorder.getBlob(),"AwesomeScreenshot-"+(new Date).toISOString().replace(/:|\./g,"-")+".webm").then(function(a){localStorage.temp_camera_url=a,window.close()}).catch(function(a){console.log(a)})})},recorder.stream.getVideoTracks()[0].onended=function(){recorder&&recorder.stream&&recorder.stream.onended&&recorder.stream.onended()},recorder.startRecording(),document.getElementById("video").setAttribute("src",window.URL.createObjectURL(a))});