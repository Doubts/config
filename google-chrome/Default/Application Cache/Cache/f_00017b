fX.prototype.OXa=fa(226,function(a){this.J=Mb(arguments,0)});function bwc(a,b,c,d,e){return PDb(a,t(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.J,!0)},a))}function lY(a,b){return B(a,2,b)}function mY(a){Mi(this,a,0,-1,null)}u(mY,Li);function nY(a){Mi(this,a,0,-1,null)}u(nY,Li);function cwc(a){return a}var dwc=[3],ewc=[1],fwc=[1],gwc=[1],hwc=[1,2],iwc=[2];
function jwc(a,b){var c=vc(a,1)?B(a,1):Number.MIN_VALUE;a=vc(a,2)?Ve(a):Number.MAX_VALUE;var d=vc(b,1)?B(b,1):Number.MIN_VALUE;b=vc(b,2)?Ve(b):Number.MAX_VALUE;return b>c&&a>d||c==d&&a==b}function kwc(a){return hc(Trc,function(b){return b.match(a)}).getName()}function lwc(a){Mi(this,a,0,-1,null)}u(lwc,Li);lwc.prototype.Qf=function(){return L(this,2)};function mwc(a){Mi(this,a,0,-1,null)}u(mwc,Li);mwc.prototype.getChartType=function(){return L(this,1)};function nwc(a){Mi(this,a,0,-1,null)}u(nwc,Li);
function owc(a){Mi(this,a,0,-1,dwc)}u(owc,Li);owc.prototype.getChartType=function(){return L(this,1)};function pwc(a){Mi(this,a,0,-1,ewc)}u(pwc,Li);function qwc(a){Mi(this,a,0,-1,fwc)}u(qwc,Li);function rwc(a){Mi(this,a,0,-1,gwc)}u(rwc,Li);function swc(a){Mi(this,a,0,-1,hwc)}u(swc,Li);var twc={dDc:0,LDa:1,jEa:2};function uwc(a){Mi(this,a,0,-1,iwc)}u(uwc,Li);
var vwc={X6a:0,SUM:1,AVERAGE:2,lia:3,k7a:4,q6a:5,MEDIAN:6,COUNT:7,m6a:8,n6a:9},wwc={UNKNOWN_ERROR:0,DDc:1,suc:2,zgc:3},xwc={qDc:0,Tgc:1,yha:2,Ck:3,jDc:4,W7b:5,iic:6},ywc={oDc:0,xF:1,yuc:2,fuc:3,Pwc:4},zwc={kDc:0,uuc:1,QK:2,Qrc:3},Awc={bDc:0,MCc:1,Skc:2,KBc:3,JBc:4,sac:5,xsc:6},Bwc={TAc:0,TABLE:1,N1a:2,HCc:3,Jzc:4,e5a:5,CDc:6,sBa:7,mza:8,Tza:9,HISTOGRAM:10},Cwc={UNKNOWN:0,I7b:1,H7b:2,G7b:3,X8b:4,I$b:5,mac:6,Rdc:7,vhc:8,atc:9,bxc:10,kxc:11,cBc:12,dBc:13,oCc:14,Cwc:15};function oY(){A.call(this)}u(oY,A);var Dwc=null;oY.prototype.Km=function(){return B(this,1)};function pY(){A.call(this)}u(pY,A);var Ewc=null;pY.prototype.getText=function(){return B(this,1)};pY.prototype.qs=function(){return vc(this,1)};function qY(){A.call(this)}u(qY,A);var Fwc=null;qY.prototype.getStatus=function(){return B(this,1)};qY.prototype.getError=function(){return B(this,9)};function rY(){A.call(this)}u(rY,A);var Gwc=null;function sY(){A.call(this)}u(sY,A);var Hwc=null;
function tY(){A.call(this)}u(tY,A);var Iwc=null;tY.prototype.wca=function(){return vc(this,1)};tY.prototype.getType=function(){return B(this,3)};tY.prototype.setType=function(a){C(this,3,a)};function uY(){A.call(this)}u(uY,A);var Jwc=null;function vY(){A.call(this)}u(vY,A);var Kwc=null;
oY.prototype.Ra=function(){var a=Dwc;a||(Dwc=a=Cc(oY,{0:{name:"Error",Nb:"ritz.assistant.Error"},1:{name:"message",Na:9,type:String},2:{name:"code",Na:14,defaultValue:0,type:wwc},3:{name:"unsupported_op_reason",Na:14,defaultValue:0,type:xwc}}));return a};oY.Ra=oY.prototype.Ra;
pY.prototype.Ra=function(){var a=Ewc;a||(Ewc=a=Cc(pY,{0:{name:"AnswerQueryPhrase",Nb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Na:9,type:String},2:{name:"start_byte",Na:5,type:Number},3:{name:"num_bytes",Na:5,type:Number}}));return a};pY.Ra=pY.prototype.Ra;
qY.prototype.Ra=function(){var a=Fwc;a||(Fwc=a=Cc(qY,{0:{name:"AnswerResponse",Nb:"ritz.assistant.AnswerResponse"},1:{name:"status",Na:5,type:Number},10:{name:"parse_status",Na:14,defaultValue:0,type:ywc},11:{name:"answer_status",Na:14,defaultValue:0,type:zwc},2:{name:"formula",Na:9,type:String},3:{name:"debug_parse_response",Na:9,type:String},4:{name:"interpretation",Na:9,type:String},5:{name:"debug_interpretation_response",Na:9,type:String},6:{name:"unused_phrase",Tc:!0,Na:11,type:pY},7:{name:"used_entity_phrase",
Tc:!0,Na:11,type:pY},8:{name:"unused_entity_phrase",Tc:!0,Na:11,type:pY},9:{name:"error",Na:11,type:oY},12:{name:"alternate_suggestion",Tc:!0,Na:11,type:tY},14:{name:"deprecated_formula_builder_used",Na:9,type:String},15:{name:"answer_visualization_type",Tc:!0,Na:14,defaultValue:0,type:Bwc},16:{name:"formula_builder_used",Na:14,defaultValue:0,type:Cwc},17:{name:"charting_info",Na:11,type:sY},18:{name:"answer_field_info",Tc:!0,Na:11,type:rY},19:{name:"charting_formula",Na:9,type:String},21:{name:"parse_info",
Tc:!0,Na:11,type:uY},22:{name:"answer_field_info_for_ranges",Tc:!0,Na:11,type:rY},23:{name:"va_query",Na:9,type:String},24:{name:"pivot_table_def",Na:11,type:Xf}}));return a};qY.Ra=qY.prototype.Ra;rY.prototype.Ra=function(){var a=Gwc;a||(Gwc=a=Cc(rY,{0:{name:"AnswerFieldInfo",Nb:"ritz.assistant.AnswerFieldInfo"},1:{name:"cell_data_type",Na:14,defaultValue:0,type:Tfa},2:{name:"range_ref",Na:9,type:String}}));return a};rY.Ra=rY.prototype.Ra;
sY.prototype.Ra=function(){var a=Hwc;a||(Hwc=a=Cc(sY,{0:{name:"ChartingInfo",Nb:"ritz.assistant.ChartingInfo"},1:{name:"suggested_type",Tc:!0,Na:14,defaultValue:0,type:Bwc},2:{name:"recommended",Na:8,type:Boolean},3:{name:"user_requested_type",Tc:!0,Na:14,defaultValue:0,type:Bwc},4:{name:"show_only_chart",Na:8,type:Boolean}}));return a};sY.Ra=sY.prototype.Ra;
tY.prototype.Ra=function(){var a=Iwc;a||(Iwc=a=Cc(tY,{0:{name:"QuerySuggestion",Nb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Na:9,type:String},2:{name:"formula",Na:9,type:String},3:{name:"type",Na:14,defaultValue:0,type:Awc},4:{name:"deprecated_formula_builder_used",Na:9,type:String},5:{name:"formula_builder_used",Na:14,defaultValue:0,type:Cwc}}));return a};tY.Ra=tY.prototype.Ra;
uY.prototype.Ra=function(){var a=Jwc;a||(Jwc=a=Cc(uY,{0:{name:"ParseInfo",Nb:"ritz.assistant.ParseInfo"},1:{name:"intent_info",Tc:!0,Na:11,type:vY}}));return a};uY.Ra=uY.prototype.Ra;vY.prototype.Ra=function(){var a=Kwc;a||(Kwc=a=Cc(vY,{0:{name:"IntentInfo",Nb:"ritz.assistant.IntentInfo"},1:{name:"intent_type",Na:14,defaultValue:0,type:vwc}}));return a};vY.Ra=vY.prototype.Ra;function wY(a,b,c,d,e,f){G.call(this,a,b);this.C=b;this.Ia=c;this.$=d||null;this.eb=e||null;this.J=f||null}u(wY,G);wY.prototype.Aj=g("Ia");wY.prototype.Xe=g("$");function Lwc(a,b,c,d,e,f,h){h=void 0===h?null:h;wY.call(this,"De",null,d,e,f);this.L=a;this.V=b;this.Cc=c;this.F=h}u(Lwc,wY);Lwc.prototype.Gd=g("Cc");function Mwc(a,b,c){wY.call(this,"Ge",null,2859);this.L=a;this.V=b;this.F=c}u(Mwc,wY);function Nwc(a,b,c,d,e,f,h){P.call(this,h);this.F=a;this.D=b;this.J=e;this.Mb=f;this.C=this.Cc=null;this.H=ij(new hj,10).build()}u(Nwc,P);p=Nwc.prototype;p.Ua=function(){Nwc.ea.Ua.call(this);(new sW(vF,this.D.mf())).send(t(this.Ssb,this,this.D))};p.Vqa=function(a,b){a=new Lwc(this.F.clone(),this.J,this.Cc,2746,a,b);this.dispatchEvent(a)};p.Ssb=function(a,b){b&&(b.Mi()?TE.eC(this.Qa,b):(b=b.Gd(),a.xe(b),NW(a,b),UE(a,"ready",t(this.y4b,this,a)),$W(a,this.Qa,this.Mb,Vn),this.Cc=b))};
p.y4b=function(a){a.qm()&&(UE(a.qm(),"onmouseover",t(this.w4b,this)),UE(a.qm(),"onmouseout",t(this.x4b,this)))};p.w4b=function(){this.C=Ha()};p.x4b=function(){pa(this.C)&&500<Ha()-this.C&&this.Mb.mc(2750,this.H);this.C=null};function xY(){}u(xY,KL);ta(xY);xY.prototype.Ec=n("waffle-assistant-link-button");function Owc(){return W('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function Pwc(a,b){P.call(this,b);this.D=a;this.C=new Us("",new xY,this.Da());this.Ya(this.C)}u(Pwc,P);p=Pwc.prototype;p.Ka=function(){this.Qa=U(Owc)};p.Ua=function(){Pwc.ea.Ua.call(this);var a=this.fb("waffle-assistant-feedback-card-link");this.C.rb(a);this.getHandler().R(this.Qa,"mousedown",this.Ug).R(this.C,"action",this.Avb);this.show(!1)};p.Ug=function(a){a.stopPropagation()};
p.show=function(a){var b=this.Qa,c=this.fb("waffle-assistant-feedback-card-link");tq(b,"waffle-assistant-feedback-card-hidden",!a);sn(c,a)};p.Avb=function(){Q.lz.Dc({source:this.D});this.show(!1);this.dispatchEvent(new G("feedback-dialog-opened"))};function yY(){}u(yY,Ss);ta(yY);yY.prototype.Ec=n("waffle-assistant-button");function zY(a,b,c){a&&(q(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Ta(b),$s(a,b,void 0),soc(a),a.setAttribute("data-tooltip-delay",500),J0b(a,q(c)?c:1))};function Qwc(){var a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+V(du({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+V(du({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return W(a)};function AY(a){P.call(this,a);this.C=new Us("",new yY,this.Da());this.Ya(this.C);this.D=new Us("",new yY,this.Da());this.Ya(this.D)}u(AY,P);AY.prototype.Ka=function(){this.Qa=U(Qwc)};AY.prototype.Ua=function(){AY.ea.Ua.call(this);var a=this.fb("waffle-assistant-thumbs-down-button");this.C.rb(a);zY(a,"Not useful");a=this.fb("waffle-assistant-thumbs-up-button");this.D.rb(a);zY(a,"Useful");this.getHandler().R(this.C,"action",this.F).R(this.D,"action",this.H)};
function Rwc(a,b){a.Da().sf(a.fb("waffle-assistant-thumbs-text"),b)}AY.prototype.F=function(){this.dispatchEvent(new G("thumbs-down"));N(this.Qa,!1)};AY.prototype.H=function(){this.dispatchEvent(new G("thumbs-up"));N(this.Qa,!1)};function Swc(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(V(a.h$a)+"</span>"),d=0==a.ZJa.length;b+='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(d)c=W('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">';a=a.ZJa;for(var e=a.length,f=0;f<e;f++){var h=a[f];c+=(0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';c=h?c+V(h):c+"(empty)";c+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}c=W(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+(d?" waffle-assistant-facet-white-section":
"")+'">'+c+(Pn?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return W(b)};function Twc(a,b,c,d,e){P.call(this,e);this.J=a;this.Sa=b;this.Mb=c;this.O=d;this.L=Ac(this.J,23);this.La=B(this.J,22);this.D=B(this.J,26);this.Ia=[];this.ad=new ch;this.V=this.F=this.C=null;this.$=!1;this.va=new bt("",this.Da());this.Ya(this.va);this.H=null}u(Twc,P);p=Twc.prototype;p.Ka=function(){Twc.ea.Ka.call(this);this.Qa=U(Swc,{h$a:this.D,ZJa:this.L});this.Qa.style.visibility="hidden"};
p.Ua=function(){Twc.ea.Ua.call(this);var a=this.fb("waffle-assistant-facet-toggle");this.va.rb(a);this.getHandler().R(this.Qa,"mousedown",this.Ug).R(this.va,"action",this.BIb);Pn&&(this.V=new Pwc("assistantAutovisFacetFeedback",this.Da()),this.V.render(this.fb("waffle-assistant-facet-feedback-container")),this.C=new AY(this.Da()),this.Ya(this.C),this.C.render(this.fb("waffle-assistant-facet-thumbs-container")),Rwc(this.C,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().R(this.C,
"thumbs-up",this.v4b).R(this.C,"thumbs-down",this.u4b));Uwc(this,hva)};p.Hd=g("$");p.ef=function(a){this.$=a;Vwc(this)};p.Ug=function(a){a.stopPropagation()};p.BIb=function(){var a=pq(this.fb("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");Uwc(this,a);Wwc(this,a?2647:2646)};
function Uwc(a,b){var c=a.fb("waffle-assistant-facet-toggle");qn(c,b?"HIDE":"SHOW");tq(a.fb("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);x(a.aj("waffle-assistant-faceted-chart"),function(a){sn(a,b)});a.C&&N(a.C.Qa,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');zY(c,b?a:d)}
function Xwc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function Ywc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function Vwc(a){a.O&&!a.$&&x(a.Ia,t(function(a){var b=a.Qa;if(!this.O.contains(b)){var d=this.O;a=new Zwc(b,a);Kub(d,a)}},a))}p.v4b=function(){Wwc(this,2649)};p.u4b=function(){Wwc(this,2648);this.V.show(!0)};function Wwc(a,b){var c=a.Mb,d=new VW,e=a.H.getChartType();d.C=e;e=a.H.Gd();d.F=e?e.clone():null;WW(c,b,d,10,a.H,a.H.mf())};function $wc(){return W('<div class="waffle-assistant-card" tabindex="0" role="region">'+(Pn?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(Pn?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function BY(a,b){var c=this;P.call(this,b);this.D=a;this.$=this.V=this.O=null;this.kb=new hX(!0,"#4285f4");this.Ya(this.kb);this.ob=this.Qb=this.kc=!1;this.Sa=new jl(function(){c.Sa.stop();c.Qa.parentNode.querySelector(":hover")==c.Qa?c.Sa.start():c.EU()},100);this.Ea(this.Sa);this.Ed=this.Gb=!1}u(BY,P);p=BY.prototype;p.hF=kd;p.yca=ld;p.rH=md;p.qH=md;p.Kaa=md;p.dpa=md;p.cpa=md;p.ef=ca("Ed");p.Hd=g("Ed");p.Vqa=sa;p.Ka=function(){this.Qa=U($wc)};
p.Ua=function(){BY.ea.Ua.call(this);var a=this.fb("waffle-assistant-card-spinner-container");this.kb.render(a);Ro(this.fb("waffle-assistant-card-inner"),"visibility","hidden");if(this.hF()){a=this.Qa;var b=new Cq(a);this.Ea(b);this.getHandler().R(b,"focusin",this.lqb).R(b,"focusout",this.kqb).R(a,"mouseenter",this.C2).R(a,"mouseleave",this.EU)}axc(this,!1);Pn&&(this.$=new Pwc(this.UC(),this.Da()),this.$.render(this.fb("waffle-assistant-card-feedback-container")),this.getHandler().R(this.$,"feedback-dialog-opened",
this.Bvb).R(this,"trigger_feedback",this.s_b),this.yca()?(this.V=new AY(this.Da()),this.V.render(this.fb("waffle-assistant-thumbs-container")),bxc(this,!0),a=eb(this.Kaa()),Ra(a)||Rwc(this.V,a),a=eb(this.dpa()),Ra(a)||zY(this.V.fb("waffle-assistant-thumbs-up-button"),a),a=eb(this.cpa()),Ra(a)||zY(this.V.fb("waffle-assistant-thumbs-down-button"),a),this.getHandler().R(this.V,"thumbs-down",this.K4b).R(this.V,"thumbs-up",this.L4b)):bxc(this,!1));this.cF()};
function CY(a){return a.fb("waffle-assistant-card-content-container")}function cxc(a){a.hF();return a.fb("waffle-assistant-card-options")}function bxc(a,b){Pn&&N(a.fb("waffle-assistant-thumbs-container"),a.yca()&&b)}p.BL=function(){this.isDisposed()||(this.kc=!0,dxc(this))};function exc(a,b){!a.Qb&&b&&(a.Qb=!0,dxc(a))}function dxc(a){if(a.kc&&a.Qb){var b=t(a.J4b,a);a.iF(b)}}p.C2=function(){this.ob||(axc(this,!0),this.ob=!0,this.Sa.start())};p.EU=function(){axc(this,!1);this.ob=!1};
p.lqb=function(){axc(this,!0)};p.kqb=function(){var a=this,b=new jl(function(){on(a.Qa,document.activeElement)||a.Qa.parentNode.querySelector(":hover")==a.Qa||axc(a,!1)},0);this.Ea(b);b.start()};p.K4b=function(){fxc(this,!0);bxc(this,!1);var a=this.qH();this.dispatchEvent(new wY("Ie",this,a))};p.L4b=function(){bxc(this,!1);var a=this.rH();this.dispatchEvent(new wY("Ie",this,a))};p.Bvb=function(){fxc(this,!1)};p.s_b=function(){fxc(this,!0)};
function axc(a,b){var c=a.fb("waffle-assistant-card-options");a=a.hF();N(c,a&&b)}p.J4b=function(){this.kb.setActive(!1);N(this.kb.Qa,!1);Ro(this.fb("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new G("content-rendered"))};function fxc(a,b){tq(a.fb("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.$.show(b)};var gxc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function hxc(a){var b=new eF(pc(gxc));return jrc(a,b)}
function ixc(a,b){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.hc("useFirstColumnAsDomain")&&a.Gd()&&"number"===a.Gd().dd(0)&&a.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==a.hc("useFirstColumnAsDomain")&&a.Gd()&&"string"===a.Gd().dd(0)){c=0;var d=Zm("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";b.appendChild(d);for(b=0;b<a.Gd().getNumberOfRows();b++)qn(d,a.Gd().Rf(b,0)),c=Math.max(c,pp(d).width);gn(d);c=Math.min(27,Math.max(15,10+100*c/271))}RQ()||Vn||(a.setOption("chartArea.top","15%"),b=a.hc("hAxis.title"),a.setOption("chartArea.height",Ra(eb(b))?"80%":"65%"),a.setOption("chartArea.left",c+"%"),a.setOption("chartArea.width",
95-c+"%"),"PieChart"==a.getChartType()&&(a.setOption("chartArea.top",Ra(eb(a.hc("title")))?"12%":"15%"),a.setOption("chartArea.height","70%"),a.setOption("chartArea.left","0%"),a.setOption("chartArea.width","100%"),a.setOption("pieSliceText","none"),a.setOption("legend.position","labeled"),a.setOption("legend.textStyle.fontSize",10)));return a};function jxc(a,b,c){var d=a.Pc(),e=a.Uc();switch(b){case 0:d=Math.min(d,a.yc()+c);break;case 1:e=Math.min(e,a.wc()+c)}return dh(a.Pb(),a.yc(),a.wc(),d,e)}function kxc(a){var b=new Gla;M(b,1,""+a.Zc);var c=a.rect.yc();M(b,2,c);c=a.rect.Pc();M(b,3,c);c=a.rect.wc();M(b,4,c);a=a.rect.Uc();M(b,5,a);return b}function lxc(a){var b=new $i;if(a){var c=new bj;a=kxc(a);Ti(c,7,a);Ti(b,58,c)}return b};function mxc(){return W('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function nxc(){return W(V(at({Ce:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:Qr(""+V(du({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+V(at({Ce:"waffle-assistant-zoom-button",content:Qr(""+V(du({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})))};function DY(a,b,c,d,e,f,h){BY.call(this,a,h);this.C=B(a,8);this.Kc=b;this.Ac=c;this.Mb=d;this.gb=e;this.Yc=f;this.L=new bt("",this.Da());this.Ya(this.L);this.va=new bt("",this.Da());this.Ya(this.va);this.ad=new ch;this.$b=null;this.Za=!1;this.Yb=[];this.Sb=[];this.sb=[];this.eb=this.La=this.F=this.H=this.Ia=null;a=lxc(this.Yc);this.J=jj(ij(new hj,10),a).build()}u(DY,BY);
var EY={S0a:"waffle-assistant-after-chart-preview",l1a:"waffle-assistant-before-chart-preview",v1a:"waffle-assistant-card-draggable",k7:"waffle-assistant-chart-highlights",X3a:"waffle-assistant-insert-chart-button",Jia:"waffle-assistant-chart-preview",U5a:"waffle-assistant-button-separator",t6a:"waffle-assistant-styled-border",u6a:"waffle-assistant-styled-rect",x7a:"waffle-assistant-zoom-button"};p=DY.prototype;p.iF=function(a){this.$b=a;oxc(this)};
p.cF=function(){pxc(this,t(function(a){a=usc(this.Kc,a);Bq(this.Qa,a)},this),!1)};p.hF=ld;p.UC=n("autovisFeedback");p.rH=n(2208);p.qH=n(2207);p.Kaa=n("Was this chart useful?");p.Ka=function(){DY.ea.Ka.call(this);CY(this).appendChild(U(mxc));cxc(this).appendChild(U(nxc));vc(this.C,22)&&(this.F=new Twc(this.C,this.O,this.Mb,this.gb,this.Da()),this.Ya(this.F,!0),this.F.ef(this.Hd()))};
p.Ua=function(){DY.ea.Ua.call(this);T(this.Qa,EY.v1a);var a=this.fb(EY.X3a);this.L.rb(a);zY(a,"Insert chart");a=this.fb(EY.x7a);this.va.rb(a);zY(a,"View full size");a=this.fb(EY.l1a);var b=this.fb(EY.Jia),c=this.fb(EY.S0a);this.getHandler().R(this.Qa,"keydown",this.r4b).R(b,"click",this.Sqb).R(a,"focus",this.Qpb).R(c,"focus",this.Fob).R(this.L,"action",this.eyb).R(this.L.Qa,"mousedown",this.Ug).R(this.va,"action",this.lKb).R(this.va.Qa,"mousedown",this.Ug).R(this.fb(EY.k7),"mousedown",this.Ug).R(Lw(this.Kc),
"Fa",this.s4b);qxc(this);this.Mb.mc(2790,this.J);this.F&&this.Mb.mc(2791,this.J)};p.ef=function(a){DY.ea.ef.call(this,a);qxc(this);this.jc()&&rxc(this)};function qxc(a){if(a.jc()){var b=a.Hd();a.L.setVisible(!b);a=a.Da().fb(EY.U5a,cxc(a));N(a,!b)}}p.r4b=function(a){13==a.keyCode&&a.target==this.Qa&&(a.preventDefault(),a.stopPropagation(),sxc(this,2255))};
function txc(a){var b=a.getChartType(),c=!!B(a.C,14),d=B(a.C,16),e=!!B(a.C,15),f="Histogram"==b;b="PieChart"==b;for(var h=IV(Ac(a.D,4)),k=1<h.length,l=[],m=0;m<h.length;m++){var r=uxc(h[m].rect,c!=b);Lb(l,r)}c=mA(a.Ac).od();var v=[];for(w in Nd)v.push(thb(c,Nd[w]));var w=sb(l,function(a){return sb(v,Fa(ke,a))});f&&e&&(w=Mb(w,1));a.sb=vxc(w.length,b&&0<d||!f&&!b&&e,b&&k);d=mA(a.Ac);for(e=0;e<w.length;e++)for(f=a.sb[e],b=0;b<w[e].length;b++)w[e][b]&&we(w[e][b])&&(k=enc(d,w[e][b],EY.u6a),a.Ea(k),uI(QJ(d),
k,!0),Ro(k.Qa,"background-color",f),k.setVisible(!0),a.Yb.push(k),k=uJ(d,w[e][b],EY.t6a,1,0),a.Ea(k),ukb(k,f),k.setVisible(!0),a.Sb.push(k))}function wxc(a){Ec(a.Yb);Ec(a.Sb);a.Yb=[];a.Sb=[];a.sb=[]}p.s4b=function(){this.Za&&(wxc(this),txc(this))};p.C2=function(){DY.ea.C2.call(this);this.La=Ha();this.Za||(txc(this),this.Za=!0)};p.EU=function(){DY.ea.EU.call(this);pa(this.La)&&500<Ha()-this.La&&this.Mb.mc(2789,this.J);this.La=null;wxc(this);this.Za=!1};p.Sqb=function(){this.Qa.focus()};
p.Qpb=function(){var a=this.fb(EY.k7);lp(a)?a.focus():this.Qa.nextSibling&&this.Qa.nextSibling.focus()};p.Fob=function(){var a;if(a=this.$)a=this.$,a.Lb("waffle-assistant-feedback-card-hidden")?a=!1:(a.fb("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.va.Qa.focus()};p.eyb=function(){sxc(this,2255)};p.Ug=function(a){a.stopPropagation()};p.lKb=function(){R.u6.Dc(this,this.J)};p.Vqa=function(a,b){sxc(this,2257,a,b)};
function sxc(a,b,c,d){pxc(a,t(function(a){a=new Lwc(a,this.O,this.H&&this.H.Gd(),b,c,d,kma(this.J));this.dispatchEvent(a)},a),!1)}
p.t4b=function(a,b){if(b){var c=this.fb(EY.Jia);if(b.Mi())TE.eC(c,b);else{a.xe(b.Gd());NW(a,a.Gd());AV(a,"ready",t(this.q4b,this,a));b=[];try{var d=new tg;d.setContext(a.toJSON());var e=!!B(this.C,14);C(d,3,e);var f=B(this.C,16);C(d,4,f);C(d,5,"ROWS"==(e?"ROWS":"COLS"));C(d,8,0);if(B(this.C,24)){var h=B(this.C,25);C(d,9,h)}var k=IV(Ac(this.D,4));for(e=0;e<k.length;e++)d.addRange(gh(k[e].rect,k[e].Zc));var l=this.ad.serialize(d);b=sb(jtc(Fa(ritz_api.RitzModelApi.getVerbalHighlightsForProto,l),a).call(),
gtc)}catch(m){b=[]}d=this.fb(EY.k7);N(d,0<b.length);0<b.length&&(d.appendChild(b[0]),sn(d,!0));this.H=a;$W(a,c,this.Mb,Vn)}}};p.q4b=function(a){null!==this.Ia&&(ai(Zh(),this.Ia),this.Ia=null);this.isDisposed()||(a.qm()&&(UE(a.qm(),"onmouseover",t(this.o4b,this)),UE(a.qm(),"onmouseout",t(this.p4b,this))),this.$b(),rxc(this))};p.o4b=function(){this.eb=Ha()};p.p4b=function(){pa(this.eb)&&500<Ha()-this.eb&&this.Mb.mc(2795,this.J);this.eb=null};
function rxc(a){if(a.gb&&!a.Hd()){var b=a.fb(EY.Jia);if(!a.gb.contains(b)){var c=a.gb;a=new Zwc(b,a);Kub(c,a)}}}function xxc(a){a.Gb&&(a.Ia=$h(Zh(),gk.qza),a.Gb=!1);B(a.C,16);var b=hxc(a.C);b.ufa(vF);var c=lrc(a.D);b.ji(c.toString());a.F&&(c=c.clone(),a.F.F=c);return b}
function oxc(a){var b=xxc(a);b=ixc(b,a.fb("waffle-assistant-card-inner"));(new sW(vF,b.mf())).send(t(a.t4b,a,b));a.F&&pxc(a,t(function(a){var c=this.F,e=b;a=new eF(a.toJSON());e=new eF(e.toJSON());var f=c.aj("waffle-assistant-faceted-chart");if(1<f.length){Ywc(a);var h=e;Xwc(h);h.setOption("pieSliceText","percentage");h.setOption("axisFontSize",0);h.setOption("hAxis.title",null);h.setOption("hAxis.textPosition","none");h.setOption("vAxes.0.title",null);h.setOption("vAxes.0.textPosition","none");h.setOption("vAxes.1.title",
null);h.setOption("vAxes.1.textPosition","none");RQ()||Vn||h.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});h.setOption("legend","none");h.setOption("titleTextStyle.fontSize",0)}else h=a,Ywc(h),h.setOption("applyAggregateData",void 0),h.setOption("legend","right"),Xwc(e);h=IV(Ac(c.J,27));Y5a(c.F,h);h=B(c.J,25);for(var k=0;k<f.length;k++){var l=na(c.L[k])?c.L[k]:null,m=h.clone(),r=c.La,v=new zg;C(v,1,r);na(l)&&v.jb(l);C(m,7,v);c.F.Vb("dt",encodeURIComponent(JSON.stringify(c.ad.serialize(m))));
r=new eF(a.toJSON());r.ji(c.F.toString());m=e.clone();m.ji(c.F.toString());var w=c,y=r.hc("title");y||(y=kwc(r));v=y+(' when "'+(w.D+('" is "'+(l+'"'))));w=y+(' by "'+(w.D+'"'));v=l?v:w;r.setOption("title",v);m.setOption("title",v);w=new Nwc(r,m,0,0,c.Sa,c.Mb,c.Da());c.Ya(w);v=f[k];w.rb(v);c.Ia.push(w);w=c;y=kwc(r);r=y+(' broken down by "'+(w.D+('" for "'+(l+'"'))));w=y+(' broken down by "'+(w.D+'"'));Bq(v,l?r:w);c.H=m}Vwc(c);c.Qa.style.visibility="visible"},a),!1)}
function pxc(a,b,c){var d=xxc(a);(new sW(vF,d.mf())).send(function(a){a?(a=a.Gd(),c&&d.xe(a),NW(d,a),b(d)):b(null)})}p.getChartType=function(){return this.C.getChartType()};function vxc(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=aqc("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Lb(d,d);return d}function uxc(a,b){return b?pnc(a,new Zd(a.width,1)):pnc(a,new Zd(1,a.height))};function Zwc(a){gL.apply(this,arguments)}ia(Zwc,gL);Zwc.prototype.qpa=g("element");function yxc(){eL.call(this);this.Za.push(this);this.Ia=this.La=!0;this.ob="waffle-assistant-dragged-card"}u(yxc,Jub);yxc.prototype.contains=function(a){return!!x(this.L,function(b){if(b.element==a)return!0})};yxc.prototype.opa=function(a){var b=yxc.ea.opa.call(this,a);if(RQ()||Vn){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=sb(b.querySelectorAll("clippath"),function(a){return a.id}),zxc(b,a);return b};
function zxc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];na(c)&&Za(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=jn(a);for(c=0;c<a.length;c++)zxc(a[c],b)};function Axc(){return W('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function FY(a,b){BY.call(this,a,b);this.C=B(a,8)}u(FY,BY);p=FY.prototype;p.cF=sa;p.UC=n("assistantWordCloudFeedback");p.rH=n(2634);p.qH=n(2633);p.Ka=function(){FY.ea.Ka.call(this);CY(this).appendChild(U(Axc));T(CY(this),"waffle-assistant-word-cloud-content-container")};
p.iF=function(a){for(var b=Ac(this.C,19),c=Ac(this.C,20),d=this.fb("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(Bxc(this,b,c,e),120<d.clientHeight){Bxc(this,b,c,e-1);break}b=this.Da();c=B(this.C,2);c=Cn(b,c);d=this.fb("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function Bxc(a,b,c,d){var e=a.fb("waffle-assistant-word-cloud-words-container");for(a=a.Da();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(Cn(a," "));var l=a.createElement("SPAN");a.appendChild(l,Cn(a,b[k]));a.appendChild(e,l);T(l,"waffle-assistant-word-cloud-word");var m=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function Cxc(a){return W('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+X(a.iconSize)+'px" width="'+X(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+X(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function Dxc(){var a=W;var b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+V(Cxc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=W(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function Exc(a){return W('<div class="waffle-assistant-panel-title-bar">'+V(at({Ce:"waffle-assistant-panel-back-button",content:Qr(""+V(du({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+V(a.title)+"</div></div>")};function GY(a){P.call(this,a);this.$b=new hX(!1,"#4285f4");this.Ya(this.$b);this.J=new P(this.Da());this.Ya(this.J);this.C=[];this.Ld=this.$e=!1;this.Kc=this.Ac=this.gb=this.O=null;this.Qb=new bt("",a,4);Gr(this.Qb,2,!1);this.Ya(this.Qb)}u(GY,P);var Fxc={defaultHelpArticleId:"6280499"};p=GY.prototype;p.Ka=function(){GY.ea.Ka.call(this);this.Qa=U(Dxc);this.Ac=this.fb("waffle-assistant-panel-content-container");this.Kc=this.fb("waffle-assistant-empty-list")};
p.Ua=function(){GY.ea.Ua.call(this);var a=this.fb("waffle-assistant-spinner-container");this.$b.render(a);this.J.rb(this.fb("waffle-assistant-panel-card-holder"));this.Qb.rb(this.fb("waffle-assistant-empty-list-learn-more"));this.getHandler().R(this.Qb,"action",this.M4b).R(this.Qa,"scroll",Coc(this.Oga,10,this))};p.setVisible=function(a){var b=this;N(this.Qa,a);x(this.C,function(a){if(!a.jc()){var c=b.J.ld();a.O=c;b.J.Ya(a,!0);a.BL()}});this.$e=a};
p.Eva=function(a,b){var c=this.Da();this.O&&this.K9();this.O=new P;this.Ya(this.O);a=mr(a,Exc,{title:b});this.gb=new bt("",this.Da());this.O.Ya(this.gb);this.gb.rb(c.fb("waffle-assistant-panel-back-button",a));zY(this.gb.Qa,"Back");this.O.getHandler().R(this.gb,"action",this.Hpb)};p.K9=function(){this.O.dispose();this.O=null};function Gxc(a,b){a.$b.setActive(b);N(a.fb("waffle-assistant-panel-pane"),!b)}p.iJ=function(a){N(this.Kc,a);N(this.Ac,!a)};
function Hxc(a,b){Fb(a.C,b);a.J.removeChild(b);a.J.Lh(b,0);a.C.push(b)}p.XI=function(a){Fb(this.C,a);-1!=zp(this.J,a)&&this.J.removeChild(a,!0)};p.O_=function(){this.J.Md(!0);Ec(this.C);this.C=[]};p.Oga=function(){var a=this.Qa;a=a.scrollTop+ip(a).height;for(var b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(exc(d,!0),b+=ip(d.Qa).height):exc(d,!1)}};p.ef=function(a){this.Ld=a;x(this.C,function(b){b.ef(a)})};p.Hd=g("Ld");p.M4b=function(){Q.Uo.Dc(Fxc)};p.Hpb=function(){this.dispatchEvent("Ae")};function Ixc(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+V(a.title)+"</div>"+V(at({Ce:"waffle-assistant-section-more-button",content:Qr("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return W(a)};function HY(a,b,c,d){P.call(this,d);this.V=a;this.kb=b;this.$=new bt("",this.Da());this.Ya(this.$);this.J=new P(this.Da());this.Ya(this.J);this.C=null;this.gb=[];this.eb=this.Za=!1;this.Mb=c}u(HY,P);p=HY.prototype;p.QQa=kd;p.Jwa=ld;p.Ka=function(){HY.ea.Ka.call(this);this.Qa=U(Ixc,{title:this.rX()})};
p.Ua=function(){HY.ea.Ua.call(this);this.J.rb(this.fb("waffle-assistant-section-card-holder"));this.$.rb(this.fb("waffle-assistant-section-more-button"));this.getHandler().R(this.$,"action",this.zAb);this.C=this.HGa();this.Ea(this.C);N(Jxc(this),this.QQa());this.setVisible(!1)};p.setVisible=function(a){if(this.jc()&&this.pb()!=a&&(N(this.Qa,a),a)){N(this.$.Qa,this.AYa());a=new bj;M(a,4,this.Nga());var b=new $i;Ti(b,58,a);a=jj(ij(new hj,10),b).build();this.Mb.mc(2774,a)}};
p.pb=function(){return this.jc()&&lp(this.Qa)};p.AYa=function(){return this.gb.length>this.V};p.HGa=function(){return new GY(this.Da())};p.ef=function(a){this.eb=a;x(Kxc(this),function(b){b.ef(a)});this.C.ef(a)};p.Hd=g("eb");p.eg=sa;
p.d6=function(a){this.gb=a;for(var b=0;b<a.length;b++){if(this.J.ld()<this.V){var c=this.Z_(a[b]);c.ef(this.eb);var d=this.J.ld();c.O=d;this.J.Ya(c,!0)}if(this.Jwa()&&(this.C.iJ(!1),c=this.C,d=this.Z_(a[b]),c.C.push(d),c.$e)){Gxc(c,!1);var e=c.J.ld();d.O=e;c.J.Ya(d,!0);d.BL()}}};function Kxc(a){var b=[];a.J.$f(function(a){b.push(a)});return b}function Jxc(a){return a.fb("waffle-assistant-section-content")}p.Ura=function(){return this.J.sca()};
p.qX=function(){this.gb=[];Ec(this.J.Md(!0));this.setVisible(!1);this.Jwa()&&(this.C.O_(),this.C.iJ(!0))};function Lxc(a){a.J.$f(function(a,c){c<this.V&&a.BL()},a)}p.e6=function(a){var b=0;if(this.Za)this.C.Oga();else if(this.Ura()){this.setVisible(!0);b=ip(this.fb("waffle-assistant-section-header")).height+ip(Jxc(this)).height;for(var c=Kxc(this),d=0;d<c.length;d++)b<a&&d<this.V?(this.aOa(c[d]),exc(c[d],!0),b+=ip(c[d].Qa).height):exc(c[d],!1)}else this.setVisible(!1);return a-b};p.aOa=sa;
p.setActive=function(a){(this.Za=a)||this.C.K9()};p.gc=g("Za");function Mxc(a,b){a.C.Eva(b,a.rX())}p.zAb=function(){this.setActive(!0);this.dispatchEvent("Fe")};p.ct=g("Mb");function IY(a,b,c,d,e){HY.call(this,20,d,c,e);this.va=a;this.L=b;this.D=new yxc;this.Ea(this.D);this.F=null;this.H=0;this.O=null}u(IY,HY);p=IY.prototype;p.Ua=function(){IY.ea.Ua.call(this);this.D.Ne();this.getHandler().R(this.D,"drag",this.n4b).R(this.D,"dragend",this.hn)};p.rX=n("Analysis");p.Y8=function(a){return 0==a};p.Z_=function(a){return"WordCloud"==B(a,8).getChartType()?new FY(a,this.Da()):new DY(a,this.va,this.L,this.ct(),this.D,this.O,this.Da())};
p.ef=function(a){IY.ea.ef.call(this,a);a&&Eub(this.D)};p.aOa=function(a){this.getHandler().Mc(a,"content-rendered",this.m4b);this.H++};p.d6=function(a,b){this.O=b||null;IY.ea.d6.call(this,a,b)};p.m4b=function(){0==--this.H&&this.dispatchEvent("Ce")};p.n4b=function(){this.F=ep(this.D.kd.target)};p.hn=function(a){var b=this.F,c=mA(this.L).Yd();if(de(EH(c,"page",!1,!1)).contains(b)){var d=CH(c,b.x,b.y,"page");c=GH(c,ie(d),"page");b=new Rd(b.x-c.left,b.y-c.top);a.C.getData().Vqa(d,b)}this.F=null};
p.Nga=n(2);function Nxc(a){var b=[];if(vc(a,25)&&(a=B(a,25)))for(var c=0;c<wc(a,1);c++){var d=B(a,1,c);if(vc(d,2)){var e=B(d,2);e&&b.push(Oxc(e,Pxc(d)))}}return b}function Qxc(a){var b=Nxc(a);vc(a,6)&&(a=B(a,6))&&b.push(Oxc(a,0));return b}function Pxc(a){return(a=vc(a,4)?B(a,4):0)?a:0}function Oxc(a,b){return{name:a,Y7a:b}};function JY(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){do var f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(d=0;d<a;d++)c.push(d);for(d=0;d<b;d++)e=Math.floor(Math.random()*(a-d)+d),f=c[d],c[d]=c[e],c[e]=f}return c.slice(0,b)}function KY(a){return a[JY(a.length,1)[0]]}function Rxc(a){var b=0;x(a,function(c,d){c.length>a[b].length&&(b=d)});return sb(a[b],function(b,d){return sb(a,function(a){return a[d]})})}
function Sxc(a){var b={};x(a,function(a){b[a]||(b[a]=0);b[a]++});Nb(a);Qb(a,function(a,d){return b[d]-b[a]})};function Txc(a,b,c){this.Ia=a;this.La=b;this.L=[];this.O=[];this.H=[];this.J=[];this.$=[];this.va=[];this.C=new Ed;this.F=new Ed;this.V=new Ed;this.D=new Ed;Uxc(this,c)}function Vxc(a,b){return Fd(a,b)?a.get(b).values.ud():[]}
function Uxc(a,b){for(var c=new Jd,d=new Jd,e=0;e<b.length;e++){for(var f=Qxc(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(Fd(a.Ia,m)){var r=a.Ia.get(m);c.add(r);h.push(r)}Fd(a.La,m)&&(m=a.La.get(m),d.add(m),k.push(m))}Wxc(a,h,k)}a.L=c.ud();a.O=d.ud();Qb(a.L);Qb(a.O);a.H=sb(a.C.ud(),function(a){return a.key});Qb(a.H);a.J=sb(a.F.ud(),function(a){return a.key});Qb(a.J);a.$=sb(a.V.ud(),function(a){return a.key});Qb(a.$);a.va=sb(a.D.ud(),function(a){return a.key});Qb(a.va)}
function Wxc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)LY(a.C,b[d],b[e]),LY(a.C,b[e],b[d]);for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)LY(a.F,b[d],c[e]),LY(a.V,c[e],b[d]);for(b=0;b<c.length;b++)for(d=b+1;d<c.length;d++)LY(a.D,c[b],c[d]),LY(a.D,c[d],c[b])}function LY(a,b,c){var d;Fd(a,b)?d=a.get(b).values:d=new Jd;d.add(c);a.set(b,{key:b,values:d})};function Xxc(a,b){this.C=a;for(var c=new Ed,d=0;d<a.wk();d++)c.set(a.Jd(d).getName().toLowerCase(),d);this.O=c;c=new Ed;for(d=0;d<wc(a,1);d++)c.set(B(a,1,d).getName().toLowerCase(),d);this.$=c;c={};for(d=0;d<this.C.wk();d++)c[B(this.C.Jd(d),11)]=d;this.va=c;c={};for(d=0;d<wc(this.C,1);d++)c[B(B(this.C,1,d),4)]=d;this.Ia=c;c=[];for(d=0;d<a.wk();d++)MY(a.Jd(d).getName())&&c.push(d);this.J=c;c=[];for(d=0;d<wc(a,1);d++)MY(B(a,1,d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<wc(a,1);d++){for(var e=B(a,
1,d).getName(),f=!0,h=0;h<Yxc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+Yxc[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Sa=c;this.eb=Zxc(a,0);this.V=Zxc(a,1);c=[];for(d=0;d<a.wk();d++).8<=B(a.Jd(d),6)&&c.push(d);this.La=c;c=[];for(d=0;d<a.wk();d++)e=a.Jd(d),.95<=Ac(e,2).length/B(e,8)&&c.push(d);this.gb=c;c=[];for(d=0;d<wc(a,3);d++){e=a.Jd(B(a,3,d));a:if(.5<Ac(e,2).length/B(e,8)||.3>wc(e,3)/wc(e,2))e=!1;else{for(f=0;f<wc(e,10);f++)if(.95<B(e,10,f)/B(e,8)){e=!1;break a}e=!0}e&&c.push(B(a,
3,d))}Qb(c);this.Za=c;this.F=$xc(a.wk());this.H=$xc(wc(a,1));this.D=new Txc(this.O,this.$,b)}function $xc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}function Zxc(a,b){for(var c=[],d=0;d<a.wk();d++)a.Jd(d).getType()==b&&c.push(d);return c}function ayc(a,b){if(0==a.length&&0==b.length)return[];for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=NY(c,a[d]);for(a=0;a<b.length;a++)d=NY(c,b[a]),c=0<d.length?d:c;return c}
function OY(a,b,c,d,e,f,h,k){var l=[a.J,a.D.L],m=[a.F];c&&(m.push(a.eb),m.push(a.La));d&&m.push(a.Za);e&&m.push(a.gb);null!=h&&-1!=h?l.push(Vxc(a.D.F,h)):f&&l.push(a.D.J);k&&l.push(a.D.H);a=ayc(m,l);b=NY(a,b);return 0<b.length?{index:KY(b),rC:3}:0<a.length?{index:KY(a),rC:1}:PY()}
function QY(a,b,c,d,e,f){var h=[a.L,a.D.O],k=[a.H];c&&k.push(a.Sa);null!=e&&-1!=e?h.push(Vxc(a.D.V,e)):d&&h.push(a.D.$);f&&h.push(a.D.va);a=ayc(k,h);b=NY(a,b);return 0<b.length?{index:KY(b),rC:3}:0<a.length?{index:KY(a),rC:1}:PY()}function byc(a,b){for(var c=5;;){var d=a.C.Jd(b),e=JY(wc(d,2),1)[0];c--;if(MY(lY(d,e))||0==c)return e}}function cyc(a,b){for(var c=5;;){var d=a.C.Jd(b),e=JY(wc(d,3),1)[0];e=B(d,3,e);c--;if(MY(lY(d,e))||0==c)return e}}
function RY(a,b){b=a.C.Jd(b);a=b.getName();MY(a)||(b=dyc(Ac(b,7)),a=null==b?a:b);return a}function SY(a,b){b=B(a.C,1,b);a=b.getName();MY(a)||(b=dyc(Ac(b,2)),a=null==b?a:b);return a}function dyc(a){for(var b=0;b<a.length;b++)if(MY(a[b]))return a[b];return null}function MY(a){return null==a?!1:50>=a.length}function PY(){return{index:-1,rC:0}}function eyc(a){for(var b=JY(a.length,2),c=[],d=0;d<b.length;d++)c.push({index:a[b[d]],rC:1});return c}
function NY(a,b){Qb(a);Qb(b);for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var Yxc=["average","total","sum","mean","median"];function TY(a){this.Za=a;this.pB=[];this.C=this.Ia=this.va=this.eO=this.mJ=null;this.V=[];this.O=new Jd;this.La=new Jd;this.$=!1;this.F=[];this.D=[]}p=TY.prototype;p.Ne=function(a,b,c,d,e){this.reset();this.mJ=b;this.eO=c;this.va=d;this.Ia=a;this.V=bva?e:[];this.C=new Xxc(a,e)};
p.Wda=function(){fyc(this);var a=[];if(bva)for(var b=0;b<this.V.length;b++){var c=this.V[b];switch(c.getChartType()){case "BarChart":if(this.Zl(13)||this.Zl(2)){var d=B(c,6);if(d&&-1!=this.C.O.get(d.toLowerCase(),-1)){var e=gyc(this,c);1<e.length&&(Tn&&this.Zl(23)?UY(this,a,"Scatter chart of "+e[0].name+" vs "+e[1].name,23,2):this.Zl(2)&&UY(this,a,"Correlation of "+e[0].name+" and "+e[1].name,2,1.5))}}break;case "ScatterChart":var f=gyc(this,c);1<f.length&&(Tn&&this.Zl(23)?UY(this,a,"Scatter chart of "+
f[0].name+" vs "+f[1].name,23,2):this.Zl(2)&&UY(this,a,"Correlation of "+f[0].name+" and "+f[1].name,2,1.5));break;case "PieChart":for(var h=[],k=Nxc(c),l=0;l<k.length&&-1!=this.C.O.get(k[l].name.toLowerCase(),-1);l++)h.push(k[l]);var m=h;1==m.length&&4==m[0].Y7a&&(Tn&&this.Zl(20)?UY(this,a,"Chart of distribution of "+m[0].name,20,2):this.Zl(14)&&UY(this,a,"Distribution of "+m[0].name,14,1.5))}}if(this.Zl(1)){var r=this.C.C,v=QY(this.C,this.D,!1,!0),w=v.index,y=OY(this.C,this.F,!0,!1,!0,!0,w),z=y.index;
if(-1!=z&&-1!=w){var E=10<=wc(r.Jd(z),2)?"5 ":"",K=RY(this.C,z),O=SY(this.C,w);if(K!=O){var S=VY(1,[v],[y]);UY(this,a,this.fMa(1)+" "+E+K+" by "+O,1,S)}}}if(this.Zl(2)&&1<wc(this.C.C,1)){a:{var ea=this.C,ha=this.D;if(2>ea.H.length)var ma=[PY(),PY()];else{var va=QY(ea,ha,!1,!1,void 0,!0),xa=va.index;if(-1!=xa){var ya=Vxc(ea.D.D,xa);if(0<ya.length){var La=[va],Va=KY(ya),fb=2,lb=NY(ya,ha);0<lb.length&&(Va=KY(lb),fb=3);La.push({index:Va,rC:fb});ma=La;break a}}ma=eyc(2<=ea.L.length?ea.L:ea.H)}}var Jb=
ma,nc=SY(this.C,Jb[0].index),gd=SY(this.C,Jb[1].index);if(nc!=gd){var ad=VY(1,Jb,[]);UY(this,a,"Correlation of "+nc+" and "+gd,2,ad)}}if(this.Zl(3)){var Sd=this.C.C,oe=QY(this.C,this.D,!0),Hb=oe.index;if(-1!=Hb){var ae=VY(1,[oe],[]);UY(this,a,this.nT(Ac(B(Sd,1,Hb),3),3)+" of "+SY(this.C,Hb),3,ae)}}if(this.Zl(5)){var Rb=this.C.C,Tc=QY(this.C,this.D,!0,!0),Md=Tc.index,yg=OY(this.C,this.F,!0,!0,!1,!0,Md),th=yg.index;if(-1!=Md&&-1!=th){var Ei=SY(this.C,Md),Fi=Rb.Jd(th),uh=RY(this.C,th);if(0<wc(Fi,3)&&
uh!=Ei){var oo=VY(1,[Tc],[yg]),ys=cyc(this.C,th);UY(this,a,this.nT(Ac(B(Rb,1,Md),3),5)+" of "+Ei+" when "+uh+" is "+lY(Fi,ys),5,oo)}}}if(this.Zl(9)){var po=QY(this.C,this.D,!1,!0),zs=po.index,Sq=OY(this.C,this.F,!0,!1,!0,!0,zs),fu=Sq.index;if(-1!=fu&&-1!=zs){var gu=SY(this.C,zs),Jp=RY(this.C,fu);if(Jp!=gu){var Kp=VY(1,[po],[Sq]);UY(this,a,Jp+" with "+this.Noa(9)+" "+gu,9,Kp)}}}if(this.Zl(10)&&0<wc(this.C.C,1)){var rk=QY(this.C,this.D),Fy=VY(1,[rk],[]),As=SY(this.C,rk.index);UY(this,a,this.Noa(10)+
" "+As,10,Fy)}if(this.Zl(11)){var cn=this.C.C,sm=OY(this.C,this.F,!0,!0,!1,!1,-1),Gi=sm.index;if(-1!=Gi){var qo=RY(this.C,Gi);if(0<wc(cn.Jd(Gi),3)){var dH=VY(1,[],[sm]);UY(this,a,"Most frequent "+qo,11,dH)}}}if(this.Zl(12)){var Bs=this.C.C,hu=QY(this.C,this.D,!0),CC=hu.index;a:{var iu=this.C;if(1==iu.V.length){var Gy=iu.V[0];if(!B(iu.C.Jd(Gy),5)){var tm=Gy;break a}}tm=-1}var DC=tm;if(-1!=DC&&-1!=CC){var eH=SY(this.C,CC),iw=Bs.Jd(DC);if(0<wc(iw,2)){var EC=VY(1,[hu],[]),FC=byc(this.C,DC);UY(this,a,
this.nT(Ac(B(Bs,1,CC),3),12)+" of "+eH+" "+KY(hyc)+" "+lY(iw,FC),12,EC)}}}if(this.Zl(15)){var GC=this.C.C,fH=QY(this.C,this.D,!0),um=fH.index,Hy=OY(this.C,this.F,!1,!0,!1,!0,um),jw=Hy.index;if(-1!=um&&-1!=jw){var HC=SY(this.C,um),Tq=RY(this.C,jw);if(Tq!=HC){var ro=GC.Jd(jw);if(2<=wc(ro,3)){var Lp=VY(1,[fH],[Hy]),IC=JY(wc(ro,3),2);UY(this,a,"Compare "+this.nT(Ac(B(GC,1,um),3),15)+" "+HC+" for "+Tq+" "+lY(ro,B(ro,3,IC[0]))+" and "+lY(ro,B(ro,3,IC[1])),15,Lp)}}}}if(this.Zl(16)){var Iy=OY(this.C,this.F,
!0,!0,!1,!1),JC=Iy.index;if(-1!=JC){var kw=RY(this.C,JC),ju=VY(1,[],[Iy]);UY(this,a,"List unique values in "+kw,16,ju)}}if(this.Zl(17)){var ku=this.C.C,Jy=OY(this.C,this.F,!0,!0,!1,!1),so=Jy.index;if(-1!=so){var KC=ku.Jd(so),lw=RY(this.C,so);if(!(1>wc(KC,3))){var SM=cyc(this.C,so),LC=VY(1,[],[Jy]);UY(this,a,"What percentage of "+lw+" is "+lY(KC,SM),17,LC)}}}if(this.Zl(13)){var MC=this.C.C,Cs=QY(this.C,this.D,!0,!0),Ky=Cs.index,mw=OY(this.C,this.F,!0,!0,!1,!0,Ky),NC=mw.index;if(-1!=Ky&&-1!=NC){var vm=
SY(this.C,Ky),lu=RY(this.C,NC);if(lu!=vm){var dl=VY(1,[Cs],[mw]);UY(this,a,this.nT(Ac(B(MC,1,Ky),3),13)+" of "+vm+" by "+lu,13,dl)}}}if(Tn&&this.Zl(18)){var OC=QY(this.C,this.D),nw=OC.index;if(-1!=nw){var Ly=VY(2,[OC],[]);UY(this,a,"Histogram of "+SY(this.C,nw),18,Ly)}}var My=3>a.length;if((My||0==JY(5,1)[0])&&this.Zl(7)){var PC=this.C.C,az=QY(this.C,this.D,!1,!0),bz=OY(this.C,this.F,!1,!1,!1,!0,az.index);if(-1!=bz.index&&-1!=az.index){var BN=PC.Jd(bz.index),CN=RY(this.C,bz.index),zla=SY(this.C,az.index);
if(0<wc(BN,2)&&CN!=zla){var YHa=VY(1,[az],[bz]),Ala=byc(this.C,bz.index);UY(this,a,"Show "+zla+" for "+CN+" "+lY(BN,Ala),7,YHa)}}}if((My||0==JY(5,1)[0])&&this.Zl(8)){var P5=this.C.C;a:{var DN=this.C,ZHa=this.F;if(2>DN.F.length)var NV=[PY(),PY()];else{var EN=OY(DN,ZHa,!0,!1,!1,!1,void 0,!0),FN=EN.index;if(-1!=FN){var OV=Vxc(DN.D.C,FN);if(0<OV.length){var Q5=[EN],GN=KY(OV),Bla=2,Cla=NY(OV,ZHa);0<Cla.length&&(GN=KY(Cla),Bla=3);Q5.push({index:GN,rC:Bla});NV=Q5;break a}}var sH=eyc(2<=DN.J.length?DN.J:
DN.F);sH[0].index!=FN&&(sH[1]=sH[0],sH[0]=EN);NV=sH}}var cz=NV,$Ha=cz[0].index;if(1<P5.wk()&&-1!=$Ha){var Dla=cz[1].index,aIa=P5.Jd(Dla),bIa=RY(this.C,Dla),dz=RY(this.C,$Ha);if(0<wc(aIa,2)&&bIa!=dz){var R5=VY(1,[],cz),Ela=byc(this.C,Dla);UY(this,a,"What is "+dz+" where "+bIa+" is "+lY(aIa,Ela),8,R5)}}}this.pB=iyc(a)};
function fyc(a){if(a.$){var b=Bw(a.Za).gk(),c=Bc(a.C.C,4);x(b,function(b){var d=b.left,f=b.width;c&&(d=b.top,f=b.height);for(b=0;b<f;b++){var h=a.C.va[d+b],k=a.C.Ia[d+b];h&&0<=h&&Bb(a.F,h);k&&0<=k&&Bb(a.D,k)}})}}p.reset=function(){this.pB=[];this.D=[];this.F=[];this.La=new Jd;this.O=new Jd};p.Xda=function(){return qj(this.pB.slice())};function iyc(a){Qb(a,function(a,c){return c.weight-a.weight});return sb(a,function(a){return a.sxa})}
function UY(a,b,c,d,e){e=a.dMa(d,e);a.La.contains(c)||(b.push({sxa:{query:c,gp:void 0,type:d},weight:e}),a.O.add(d),a.La.add(c))}p.Zl=function(a){return!this.O.contains(a)};function jyc(a,b){return a.Xda().then(function(a){return a.length<=b?a:Mb(a,0,b)},null,a)}function VY(a,b,c){x(b,function(b){3==b.rC&&a++});x(c,function(b){3==b.rC&&a++});return a}function gyc(a,b){var c=[];b=Nxc(b);for(var d=0;d<b.length&&-1!=a.C.$.get(b[d].name.toLowerCase(),-1);d++)c.push(b[d]);return c}
p.nT=function(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=kyc;break a;case 4:a=lyc;break a}a=myc}return KY(a)};p.fMa=function(){return KY(nyc)};p.Noa=function(){return KY(oyc)};var myc=["Average","Median"],kyc=["Total","Average","Median"],lyc=["Median"],oyc="Minimum Maximum Most Least Highest Lowest".split(" "),nyc=["Top","Bottom"],hyc=["before","after"];function pyc(a,b,c){TY.call(this,a);this.J=[];this.L=this.H=null;this.Sa=b;this.Mb=c;this.eb=ij(new hj,10).build()}ia(pyc,TY);p=pyc.prototype;p.Wda=function(){this.reset();TY.prototype.Wda.call(this);ava&&qyc(this)};p.reset=function(){TY.prototype.reset.call(this);this.J=[];this.H&&(this.H.cancel(),this.H=null)};p.Xda=function(){return ava&&this.H?this.H.then(function(){return this.J.slice()},null,this):TY.prototype.Xda.call(this)};p.dMa=function(a,b){return Math.pow(Math.random(),1/(ryc(a)*b))};
p.eg=ca("L");function ryc(a){switch(a){case 13:return.34;case 3:return.37;case 12:return.25;case 5:return.3;case 15:return.34;case 2:return.43;case 8:return.76;case 9:return.35;case 14:return.47;case 11:return.4;case 7:return.37;case 10:return.36;case 17:return.41;case 1:return.42;case 16:return.3;default:return.3}}
function qyc(a){var b=null;a.H=new oj(function(a){if(!this.L||3<=this.L.getStatus().getState().C)this.J=this.pB,a();var c=nx(this.mJ.rect),e=sb(this.pB,function(a){return a.query});c=Bl(Al(Ak(Ck(Dk(this.L.nf("/answers/parsesuggestions").Zf("gid",this.mJ.Zc,"range",c),t(function(b){syc(this,b).then(a)},this)),t(function(b){8==b.errorCode&&this.Mb.mc(2833,this.eb);this.J=this.pB;a()},this)).setContent(["queries",ul(e)]).setTimeout(2E3),1)),"POST");Zn&&this.eO&&null!=this.va&&(e=0==this.eO.rect.width||
0==this.eO.rect.height?"":nx(this.eO.rect),c.Zf("headerRange",e,"tableRecordDimension",""+this.va));b=c.Ke()},a);vj(a.H,function(){b&&b.dispose()})}function syc(a,b){return a.Sa.C.D.$d.then(function(){var a=[];if(b.Wl())for(var d=b.Ff(),e=0;e<d.length;e++){var f;if(f=d[e])f=!!this.Ia&&!!B(this.Ia,4),f=tyc(this.Sa,d[e],this.mJ,f),f=uyc(f);f&&(this.pB[e].gp=d[e],a.push(this.pB[e]))}this.J=a},function(){this.J.length=0},a)};var vyc={};Xb({X6a:{type:0,rB:"",nB:[]},SUM:{type:1,rB:"Sum",nB:[3,5,13,12,15]},AVERAGE:{type:2,rB:"Average",nB:[3,5,13,12,15]},lia:{type:3,rB:"Mode",nB:[3]},k7a:{type:4,rB:"Variance",nB:[3]},q6a:{type:5,rB:"Standard deviation",nB:[3]},MEDIAN:{type:6,rB:"Median",nB:[3,5,13,12]},COUNT:{type:7,rB:"Count",nB:[]},m6a:{type:8,rB:"Bottom",nB:[1,10,14]},n6a:{type:9,rB:"Top",nB:[1,11,10,14]}},function(a){vyc[a.type]=a});function wyc(a){if(a=vyc[a])return a};function xyc(a){TY.call(this,a);this.H=[]}ia(xyc,TY);p=xyc.prototype;p.reset=function(){TY.prototype.reset.call(this);this.H=[]};p.dMa=function(a,b){return 1+b};p.Zl=function(a){return!this.O.contains(a)&&0<yyc(this,a).length};p.fMa=function(a){return zyc(this,a)};p.nT=function(a,b){return zyc(this,b)};p.Noa=function(a){return zyc(this,a)};function Ayc(a,b){a.reset();x(b,function(b){x(Ac(b,1),function(b){a.H.push(B(b,1))},a)},a);Sxc(a.H);a.Wda();return jyc(a,3)}
function yyc(a,b){return rb(a.H,function(a){return yb(wyc(a).nB,b)},a)}function Byc(a,b){a=wb(a.H,function(a){return wyc(a).type==b},a);return wyc(a)}function zyc(a,b){b=yyc(a,b);return Byc(a,KY(b)).rB};var Cyc="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),Dyc=[{vk:["Thank you","Thankyou","Thanks"],Vg:"No problem"},{vk:["you are amazing","This is great","omg"],Vg:"Happy to help"},{vk:["I love you"],Vg:"Must be in the air"},{vk:["How do you know","How are you so smart"],Vg:"It's all in the data"},{vk:["Are you sure"],Vg:"Send feedback if this doesn't seem correct to help improve accuracy"},{vk:["How are you"],Vg:"Pretty good, thanks"},
{vk:["Hi","Hello","Hey"],Vg:"Hi, there. Try asking a question about your data."},{vk:["You are stupid","This is dumb","You are wrong"],Vg:"Help improve this experience by sending feedback"},{vk:["How smart are you"],Vg:"Pretty smart"}];function Eyc(a){for(var b=0;b<Dyc.length;++b)if(-1!=xb(Dyc[b].vk,function(b){return Na(a,b)}))return b;return-1};function Fyc(a,b,c,d){var e=new pwc;M(e,2,c);x(b,function(a){Oi(e,1).push(a)});M(e,3,d);d=new mY;M(d,1,a);M(d,3,b[c]);Ti(d,11,e);return d}function Gyc(a,b,c,d){var e=new rwc;M(e,2,c);x(b,function(a){Oi(e,1).push(a)});M(e,3,d);d=new mY;M(d,1,a);M(d,2,b[c]);Ti(d,10,e);return d}function Hyc(a){var b=new swc;x(a,function(a){var c=a.type;Oi(b,1).push(c);a.AKa&&(a=a.AKa,Oi(b,2).push(a))});return b}function Iyc(a){var b=new qwc;x(a,function(a){a=a.type;Oi(b,1).push(a)});return b}
function Jyc(a,b,c,d){var e=new owc;a&&M(e,1,a);b&&M(e,2,b);for(a=0;a<c.length;a++)b=c[a],Oi(e,3).push(b);M(e,4,d);return e};function WY(a,b){this.D=a;this.C=b}WY.prototype.getChartType=g("D");var XY={2:new WY("ColumnChart","Column chart"),3:new WY("LineChart","Time series"),4:new WY("ScatterChart","Scatter chart"),5:new WY("PieChart","Pie chart"),10:new WY("Histogram","Histogram"),7:new WY("LineChart","Line chart")};function YY(a,b,c,d,e,f,h){this.D=a;this.l_=b;this.H=(void 0===h?null:h)||b;this.C=d;this.gp=c;this.Sa=d?Ac(d,6):[];this.Za=d?Ac(d,7):[];this.La=d?Ac(d,8):[];this.error=e||1;this.interpretation=d&&vc(d,4)?B(d,4):null;this.O=d?Ac(d,12):[];this.Ia=d?Ac(d,21):[];this.va=f;this.F=null;this.$=this.J=!1;this.L=[];this.V=null;Tn&&Kyc(this)}function Lyc(a){return 1==a.error&&null!=a.gp}
function Myc(a){return{OO:Nyc(a),interpretation:a.interpretation,l_:a.l_,gp:a.gp,t3:1<a.l_.length&&1<a.l_[0].length,Rl:a.Rl(),JYb:a.$,M2:a.M2(),rLb:a.L}}YY.prototype.Rl=function(){return Tn&&null!=this.F&&(this.F in XY?!0:!1)&&2<this.H.length};YY.prototype.M2=function(){return Sn&&Sh(I(),"feapt")&&null!==this.C&&vc(this.C,24)};YY.prototype.getChartType=function(){if(!this.Rl())return null;var a=this.F;if(a in XY)return XY[a].getChartType();throw Error("Unknown chart type.");};
function Oyc(a){a.Rl();return a.H[0][0]}function Pyc(a){return sb(Ac(a.C,22),function(b){if(B(b,2)){var c=a.va.C;return lx(B(b,2),c)}},a)}function Qyc(a){return{OO:Nyc(a),error:Ryc(a)}}function Syc(a,b,c){var d=c.length;if(0==d)return a;1<d&&Fb(a,10);c=B(c[0],1);2<d&&9==c&&Fb(a,4);2<d&&Fb(a,5);2!=c&&3!=c&&12!=c&&Fb(a,3);yb(b,10)&&yb(a,10)&&Uaa(a,function(a){return 10!=a});return a}
function Kyc(a){var b=null;a.J=!1;a.F=null;if(a.C&&vc(a.C,17)){var c=B(a.C,17);a.$=B(c,4)||!1;var d=Ac(c,3),e=Syc(Ac(c,1),d,Ac(a.C,18));0<d.length&&(0==e.length||1>=a.H.length||1>a.H[0].length)?a.L.push("Charts for this question are not supported."):(0<d.length?(b=rb(e,function(a){return yb(d,a)}),c=rb(d,function(a){return!yb(e,a)}),Fb(c,6),0<b.length?(a.J=!0,a.F=b[0],b=a.F):yb(d,10)&&yb(e,2)?(a.J=!0,a.F=2,Fb(c,10),b=a.F):(b=0<c.length?c[0]:6,a.J=!0,a.F=Tyc(a,e)),0<c.length&&a.L.push("Requested chart type is not supported for this question.")):
0<e.length&&1<a.H.length&&1<a.H[0].length&&(a.F=Tyc(a,e),a.J=B(c,2)||!1,20<=a.H.length||3<=a.H[0].length)&&(a.J=!0),a.V=Jyc(a.F,b,e,a.J))}}function Tyc(a,b){if(!Ac(a.C,18).length)return b[0];a=Uyc(a);a=ritz_api.AssistantApi.getAnswersChartsRecommedation(a.toJSON());for(var c=0;c<a.length;c++)if(yb(b,a[c]))return a[c];return b[0]}function Vyc(a,b,c){var d={};null!=b?(d.v=Wyc(a,b,c),d.f=b):d.v=null;return d}
function Uyc(a){for(var b=new LE,c=a.H[0],d=Mb(a.H,1),e=Ac(a.C,18),f=[],h=0;h<c.length;h++)e[h]&&vc(e[h],1)?f.push(Xyc(B(e[h],1))):f.push(0==h?"string":"number"),b.Ct({type:f[h],label:c[h]||"",id:"Axis"+h});for(e=0;e<d.length;++e){h=[];for(var k=0;k<c.length;k++)h.push(Vyc(a,d[e][k],f[k]));b.sx(h)}return b}
function Wyc(a,b,c){switch(c){case "boolean":return"true"==b.toLowerCase()||"1"==b;case "number":return b=b||"0",a=$Ma(a.va.L.C).DECIMAL_SEP,b=b.replace(new RegExp("[^-0-9"+a+"]","g"),""),b=b.replace(a,"."),mb(b);case "date":case "datetime":return new Date(b);case "timeofday":if(b){a=b.replace(/[^a-zA-Z0-9]/g," ").split(" ");c=[0,0,0,0];if(!(2>a.length)&&Sa(a[0])&&Sa(a[1])&&(Sa(a[a.length-1])||"am"==a[a.length-1].toLowerCase()||"pm"==a[a.length-1].toLowerCase())){for(var d=0;d<b.length&&4>d;d++)Sa(a[d])&&
(c[d]=mb(a[d]));"am"==a[a.length-1].toLowerCase()&&12==c[0]&&(c[0]=0);"pm"==a[a.length-1].toLowerCase()&&12!=c[0]&&(c[0]+=12)}b=c}else b=[0,0,0,0];return b;default:return b||""}}function Xyc(a){switch(a){case 1:return"boolean";case 9:return"number";case 2:return"date";case 3:return"datetime";case 12:return"timeofday";default:return"string"}}
function Yyc(a){if(!vc(a.C,9))return"";if(vc(a.C.getError(),3))switch(B(a.C.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";
default:return"Sorry, this function is not supported at this time."}return a.C.getError().Km()||""}
function Ryc(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return Yyc(a)||"Sorry, couldn't understand your question.";case 7:return a=Eyc(a.D),-1!=a?Dyc[a].Vg:""}return""}
function Nyc(a){var b=[];if(Lyc(a)){var c=[];x(Ib(a.Sa,a.La),function(a){c.push(Zyc(a,"waffle-assistant-answercard-question-unused-phrase"))});x(a.Za,function(a){c.push(Zyc(a,"waffle-assistant-answercard-question-used-entity"))});Qb(c,function(a,b){return a.mB>b.mB?1:-1});var d=0;x(c,function(c){var e=c.length,h=c.mB;h>d?b.push({text:a.D.substring(d,h),className:null}):(e-=d-h,h=d);0<e&&(d=h+e,b.push({text:a.D.substring(h,d),className:c.ul}))});d<a.D.length&&b.push({text:a.D.substring(d),className:null})}else b.push({text:a.D,
className:null});return b}function Zyc(a,b){return{mB:B(a,2),length:B(a,3),ul:b}};function $yc(a){this.Mb=a}function azc(a,b){var c=new nY;M(c,3,b);M(c,8,tva);b=new jV;Ti(b,4,c);c=new $i;Ti(c,46,b);c=jj(ij(new hj,10),c).build();a.Mb.mc(2753,c)};function bzc(a,b,c,d,e,f){G.call(this,"sqc");this.V=a;this.F=f||"";this.L=b;this.J=d;this.$=e;this.C=c}u(bzc,G);function czc(a,b,c,d,e,f,h){d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;h=void 0===h?null:h;G.call(this,"answers-submit-query");this.C=a;this.V=b;this.L=c;this.J=d;this.$=e;this.F=f;this.Ia=h}u(czc,G);function dzc(a,b,c){this.J=a;this.D=[];this.C=[];this.F=b;this.H=c}u(dzc,D);function ZY(a,b){$Y(a);ezc(a,b)}function ezc(a,b){if(b){var c=mA(a.J);b=b.rect;if(we(b)&&0!=b.width&&0!=b.height&&c){var d=wob(c,b,a.H);a.Ea(d);d.setVisible(!0);a.D.push(d);c=uJ(c,b,a.F,1,0);a.Ea(c);c.setVisible(!0);a.C.push(c)}}}function $Y(a){Ec(a.D);Ec(a.C);a.D=[];a.C=[]};function aZ(a,b,c,d){H.call(this);this.V=a;this.O=b;this.va=c;this.Za=d;this.Ta=new J(this);this.Ea(this.Ta);this.C=new fX;this.Ea(this.C);this.L="";this.J=[];this.F=this.D=this.H=null;this.$=!1;Esc(this.C,this.V);this.C.Ia=10;this.C.kb=!0;this.C.O=!1;this.C.OXa("waffle-assistant-visible");this.C.va=Ta("waffle-assistant-dragged-formula").split(" ");this.C.Ne();this.Ta.R(this.C,xsc,this.La).R(this.C,Asc,this.Sa).R(this.C,Bsc,this.Ia)}u(aZ,H);aZ.prototype.ef=ca("$");
aZ.prototype.La=function(a){a=pb(this.V.childNodes,a.C);this.L=this.J[a]};
aZ.prototype.Sa=function(a){var b=a.event instanceof Kq?a.event.nN:a.event;this.$?(a.J.lA(b,!0),a.preventDefault()):(Xo(a.F,a.event.clientX,a.event.clientY),a=Yo(a.F),b=mA(this.O).Yd(),de(EH(b,"page",!1,!1)).contains(a)?(a=CH(b,a.x,a.y,"page"),(b=jy(Bw(this.va),a.y,a.x))?a=new Rd(b.wc(),b.yc()):b=ie(a),this.H=a,this.D&&this.D.getRect().equals(b)||(a=mA(this.O),F(this.D),this.D=enc(a,b,"waffle-assistant-formula-insertion-rect"),this.Ea(this.D),uI(QJ(a),this.D),F(this.F),this.F=uJ(a,b,"waffle-assistant-formula-insertion-border",
2,0),this.Ea(this.F),ukb(this.F,"#000"),this.F.setVisible(!0))):fzc(this))};aZ.prototype.Ia=function(a){if(this.H){JJ(mA(this.O),!1);var b=this.H,c=Bw(this.va);b=new WH(c,b,this.L);this.Za.C(b);this.dispatchEvent(new G("formula_inserted"))}a.J.lA(null,!0);a.preventDefault();this.L="";fzc(this)};function fzc(a){a.H=null;F(a.D);a.D=null;F(a.F);a.F=null};function gzc(a){var b=a.error,c=a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+V(du({icon:"docs-icon-img docs-icon-unsupported-black"}))+'</div><div class="waffle-assistant-errorcard-content">';c?(b=V(b)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',a+='<div class="waffle-assistant-errorcard-text">'+b+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+V(b)+"</div>";
return W(a+"</div></div>")};function hzc(a){var b=W,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+izc({OO:a.gC.OO}),d=a.gC.l_;var e=a.gC.gp;var f=a.gC.interpretation,h=a.gC.t3,k=a.gC.Rl,l=a.gC.JYb,m=a.gC.M2;a=a.gC.rLb;!d||za(d);za(a);var r=""+('<div class="waffle-assistant-answercard-answer-container"><div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+Tr("Answer")+'"><span aria-hidden="true">Answer</span></div>'+(f?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
V(f)+"</div></div>":"")+'<div class="waffle-assistant-answercard-answer-content">');if(d){if(!l){k&&(r+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-chart-tab" id="waffle-assistant-answercard-chart-tab">CHART</div></div>');r+='<div class="waffle-assistant-answercard-answer">';if(h){r+='<div class="waffle-assistant-answercard-answer-rowheader">';l=d[0];f=l.length;for(var v=0;v<f;v++)r+='<span class="waffle-assistant-answercard-answer-col">'+
V(l[v])+"</span>";r+="</div>"}r+='<div class="waffle-assistant-answercard-answer-rows">';l=Pr("waffle-assistant-answercard-answer-row"+(h?" waffle-assistant-answercard-answer-list-row":""));f=d.length;for(v=0;v<f;v++){var w=d[v];if(h&&0==v)w="";else{var y=l;za(w);y='<div class="'+X(y)+'">';for(var z=w.length,E=0;E<z;E++){var K=w[E];y=K?y+('<span class="waffle-assistant-answercard-answer-col">'+V(K)+"</span>"):y+('<span class="'+X("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+
'">N/A</span>')}w=W(y+"</div>")}r+=w}r+="</div></div>"}r+=k?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart-type-select"></div><div class="waffle-assistant-answercard-chart"></div></div>':"";m&&(r+='<div class="waffle-assistant-answercard-insert-pivot">INSERT PIVOT TABLE</div>')}if(0<a.length){r+='<div class="waffle-assistant-answercard-info-msgs">';d=a.length;for(h=0;h<d;h++)r+='<div class="waffle-assistant-answercard-info-msg">* '+V(a[h])+
"</div>";r+="</div>"}r+='<div class="waffle-assistant-answercard-footer">';k&&(r+='<div class="waffle-assistant-answercard-insert-chart">INSERT CHART</div>');r+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-help">Click to copy or drag to insert</div><div class="waffle-assistant-answercard-formula-display"><div class="waffle-assistant-answercard-formula-icon">'+
V(du({icon:"docs-icon-img docs-icon-insert-formula"}))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+V(e)+"</div></div></div></div></div></div></div></div>";e=W(r);return b(c+e+"</div></div>")}
function izc(a){za(a.OO);a=a.OO;var b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+Tr("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+X(e.className)+'">'+V(e.text)+"</span>":V(e.text)}return W(b+"</div></div></div>")}
function jzc(){var a=W;var b=W('<div class="waffle-assistant-answers-card-remove">'+V(du({icon:"docs-icon-img docs-icon-trash"}))+"</div>");return a(V(b))};function bZ(a,b,c,d,e,f,h,k,l,m,r){BY.call(this,new vw,r);this.C=a;this.If=Pyc(a);this.$b=a.Rl();this.Ld=a.M2();this.Ac=a.Rl()&&a.J;this.Yb=a.$;this.eb=!1;this.Zd=b;this.Bd=c;this.Yc=d;this.jg=h;this.Mb=e;this.Ze=f;this.Fe=k;this.uf=m;this.Kc=ij(new hj,10).build();this.Sb=new Us("",new yY,this.Da());this.Ya(this.Sb);this.L=null;this.J=new Us("",new xY,this.Da());this.Ya(this.J);this.Ia=new Us("",new xY,this.Da());this.Ya(this.Ia);this.La=new Us("",new yY,this.Da());this.Ya(this.La);this.H=new VV;
this.Ya(this.H);this.va=new bJ("");this.Ya(this.va);this.F=null;this.Cc=Uyc(this.C);this.gb=new dzc(b,"waffle-assistant-answers-range-styled-border","waffle-assistant-answers-range-styled-rect");this.Ea(this.gb);this.sb=!1;this.Za=new Us("",new yY,this.Da());this.Ya(this.Za)}u(bZ,BY);p=bZ.prototype;p.goa=g("Fe");p.Ka=function(){bZ.ea.Ka.call(this);cxc(this).appendChild(U(jzc))};
p.Ua=function(){bZ.ea.Ua.call(this);var a=this.fb("waffle-assistant-answers-card-remove");this.Sb.rb(a);zY(a,"Remove card",0);this.getHandler().Mc(this.Sb,"action",this.A4b).R(this.J,"action",this.MFb).R(this.Ia,"action",this.ixb).Mc(this.J,"action",t(this.VSa,this,!0)).Mc(this.Ia,"action",t(this.VSa,this,!1))};
p.iF=function(a){CY(this).appendChild(U(hzc,{gC:Myc(this.C)}));this.J.rb(this.fb("waffle-assistant-answercard-see-formula-link"));this.Ia.rb(this.fb("waffle-assistant-answercard-hide-formula-link"));this.L=new aZ(this.fb("waffle-assistant-answercard-formula-text-container"),this.Zd,this.Bd,this.Yc);this.L.ef(this.Hd());this.L.J=[this.C.gp];this.Ea(this.L);var b=this.fb("waffle-assistant-answercard-formula-text");Bq(b,"Formula: "+(this.C.gp+". Click/Press ENTER to copy or drag to insert on to sheet."));
this.getHandler().Mc(this.L,"formula_inserted",this.gNb).$h(this.fb("waffle-assistant-answercard-formula-text"),ed,this.twb);kzc(this,this.uf);lzc(this);if(this.$b){if(this.Yb)mzc(this,this.C.getChartType()),this.eb=!0;else{this.H.rb(this.fb("waffle-assistant-answercard-tabs"));b=new TV("");b.rb(this.fb("waffle-assistant-answercard-formula-tab"));this.H.Ya(b);var c=new TV("");c.rb(this.fb("waffle-assistant-answercard-chart-tab"));this.H.Ya(c);this.getHandler().R(this.H,"select",this.bIb).Mc(b,"action",
t(this.TSa,this,0)).Mc(c,"action",t(this.TSa,this,1));this.H.Pw(this.Ac?c:b)}b=Ac(B(this.C.C,17),1);for(c=0;c<b.length;c++)this.va.Nd(nzc(b[c]));this.va.rb(this.fb("waffle-assistant-answercard-chart-type-select"));Pt(this.va,nzc(this.C.F));b=this.fb("waffle-assistant-answercard-insert-chart");this.La.rb(b);ozc(this);this.getHandler().R(this.La,"action",this.z4b).R(this.va.Gc(),"action",this.Wqb)}this.Ld&&(b=this.fb("waffle-assistant-answercard-insert-pivot"),this.Za.rb(b),this.getHandler().R(this.Za,
"action",this.myb));a()};p.Ifa=function(){return this.$b&&!this.Yb&&!this.Ac};function nzc(a){if(a in XY)return new ut(XY[a].C,a);throw Error("Unknown chart type.");}p.Wqb=function(a){a=a.target.mb();if(a in XY)mzc(this,XY[a].getChartType());else throw Error("Unknown chart type model.");};
function mzc(a,b){a.F=new ow;C(a.F,1,b);C(a.F,2,a.C.interpretation||"");if("Histogram"===b)b=Oyc(a.C),C(a.F,3,b),C(a.F,6,"Count");else if("LineChart"===b||"ColumnChart"===b)b=0,"number"!=a.Cc.dd(0)&&(b=a.Cc.Bg(0),C(a.F,3,b),b=1),1==a.Cc.getNumberOfColumns()-b?(b=a.Cc.Bg(b),C(a.F,6,b)):C(a.F,6,"Values");else{b=a.F;var c=Oyc(a.C);C(b,3,c);c=a.C;c.Rl();C(b,6,c.H[0][1]||"")}b=hxc(a.F);b.xe(a.Cc);c=a.fb("waffle-assistant-answercard-chart");b=ixc(b,c);NW(b,b.Gd());b.setOption("title","");$W(b,c,a.Mb,Vn);
a.eb=!0}p.myb=function(){var a=Bw(this.Bd),b=this.C;b.M2();b=b.C?B(b.C,24):null;a=a.Bc();b=YXa(b,a,new Rd(0,0),0);this.Yc.C(new Ttc(b,a))};p.z4b=function(){if(this.F){var a=hxc(this.F);a.xe(this.Cc);NW(a,a.Gd());var b=this.O,c=this.Cc,d=this.C.F,e=new mwc;M(e,1,d);d=new nY;Ti(d,11,e);e=new jV;Ti(e,4,d);d=new $i;Ti(d,46,e);this.dispatchEvent(new Lwc(a,b,c,2874,void 0,void 0,d))}};p.cF=function(){Bq(this.Qa,"Answer Card for question: "+this.C.D)};p.hF=ld;p.UC=n("assistantAnswersFeedback");p.rH=n(2628);
p.qH=n(2627);p.Kaa=n("Was this answer correct?");p.dpa=n("Correct");p.cpa=n("Incorrect");p.PP=g("C");p.ef=function(a){bZ.ea.ef.call(this,a);this.L&&this.L.ef(a);lzc(this);ozc(this)};p.C2=function(){bZ.ea.C2.call(this);if(!this.sb){var a=this.gb,b=this.If;$Y(a);for(var c=0;c<b.length;c++)ezc(a,b[c]);this.sb=!0}};p.EU=function(){bZ.ea.EU.call(this);$Y(this.gb);this.sb=!1};p.bIb=function(){switch(WV(this.H)){case 0:pzc(this,!1);break;case 1:pzc(this,!0);break;default:WV(this.H)}};
function pzc(a,b){N(a.fb("waffle-assistant-answercard-chart-container"),b);N(a.fb("waffle-assistant-answercard-answer"),!b);N(a.fb("waffle-assistant-answercard-formula-holder"),!b);ozc(a);!a.eb&&b&&mzc(a,a.C.getChartType())}function lzc(a){var b=a.Lb("waffle-assistant-answercard-formula-help");b&&N(b,!a.Hd())}function ozc(a){var b=(a.Yb||1==WV(a.H))&&!a.Hd();a.La.setVisible(b)}
function kzc(a,b){a.J.setVisible(!b);a.Ia.setVisible(b);N(a.fb("waffle-assistant-answercard-formula"),b);b?a.fb("waffle-assistant-answercard-formula-text").focus():(a.J.Qa.focus(),a.J.wq(!0))}p.A4b=function(){azc(this.Ze,!0);this.dispatchEvent(new G("rc"))};p.MFb=function(){kzc(this,!0)};p.ixb=function(){kzc(this,!1)};p.VSa=function(a){var b=new nY;M(b,9,a);a=new jV;Ti(a,4,b);b=new $i;Ti(b,46,a);b=jj(ij(new hj,10),b).build();this.Mb.mc(2849,b)};
p.TSa=function(a){var b=this.C.V,c=new nwc;Ti(c,1,b);switch(a){case 0:M(c,2,2);break;case 1:M(c,2,1);break;default:M(c,2,0)}a=new nY;Ti(a,10,c);c=new jV;Ti(c,4,a);a=new $i;Ti(a,46,c);c=jj(ij(new hj,10),a).build();this.Mb.mc(2850,c)};p.gNb=function(){this.Mb.mc(2709,this.Kc)};
p.twb=function(){var a=this.Da().Wb(),b=a.createElement("textarea");b.textContent=this.C.gp;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&(cZ(this.jg,"Formula copied to clipboard",this.Da()),this.Mb.C(35534,this.Kc))};function qzc(){this.F=[];this.D={};this.J=null;this.C=new VP}function rzc(a,b,c,d){function e(a){return a.toLowerCase()}Nb(b,void 0,e);Nb(c,void 0,e);Nb(d,void 0,e);x(b,a.H,a);x(c,a.H,a);x(d,a.H,a)}qzc.prototype.H=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function szc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}qzc.prototype.$I=function(a,b,c){if(Ta(a||"")){var d=this.J.$m();d=tzc(this,a.substring(0,d));var e=uzc(this,b-d.length,a);d=Ib(d,e)}else d=uzc(this,b);d.length>b&&(d=Mb(d,0,b));c(a,d)};
function uzc(a,b,c){var d=c||"";c=Yb(a.D,function(a){return Na(a,d)});var e=vzc(cc(c),d?1:2,1);a=rb(a.F,function(a){return Na(a.query,d)&&!e[a.query.toLowerCase()]});b=vzc(a,b-bc(e),2);b=cc(b);var f=sb(b,function(a,b){a.txa=b;return a.vZa});x(b,function(a){a.rxa=f});return Ib(b,cc(e))}
function tzc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h={},k=0;k<f.length&&0<d;h={gga:h.gga,U3:h.U3,HV:h.HV},++k)if(0==k||" "==f[k-1]&&" "!=f[k]){h.HV={};h.U3=0;h.gga=f.substr(k);var l=a.C.Ue(h.gga);x(l,function(b){return function(c){var d=c.length-b.gga.length;b.U3=Math.max(d,b.U3);c=a.C.get(c);b.HV[d]||(b.HV[d]=[]);Lb(b.HV[d],c)}}(h));for(l=0;l<=h.U3&&0<d;++l){var m=h.HV[l];if(m)for(var r=0;r<m.length&&0<d;++r){var v=m[r];Za(b.toLowerCase(),v.toLowerCase())||e[v]||(--d,c.push({text:v,gp:"",
oB:0,QFa:f.length-k,vZa:void 0,rxa:[],txa:-1}),e[v]=!0)}}}return c}function vzc(a,b,c){b=JY(a.length,Math.min(a.length,b));var d={};x(b,function(b){b=a[b];var e=na(b)?b:b.query;d[e.toLowerCase()]={text:e,gp:na(b)?"":b.gp,oB:c,QFa:0,vZa:na(b)?void 0:b.type,rxa:[],txa:-1}});return d};function dZ(){iI.call(this,"",null,!1)}u(dZ,iI);dZ.prototype.tE=function(a,b){if(2==a.oB||1==a.oB)return dZ.ea.tE.call(this,a.text,b);var c=this.bb(),d=this.$m(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.QFa)+a.text;e||(f+=" ");a=dZ.ea.tE.call(this,{toString:function(){return f+c.substring(d)}},b);b=this.Dk;b.blur();b.focus();this.V4(f.length);return a};
dZ.prototype.Hg=function(a){var b=dZ.ea.Hg.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,fjb(b)&&b.AH()&&a.preventDefault(),b=!0);return b};function wzc(){return W('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+V(du({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+V(du({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+V(du({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function xzc(a){this.yb=a||Nm()}
xzc.prototype.Iw=function(a,b,c){b=U(wzc);var d=this.yb.fb("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.yb.sf(d,a.text);d=this.yb.fb("waffle-assistant-answers-ac-entity-icon",b);var e=this.yb.fb("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.yb.fb("waffle-assistant-answers-ac-session-query-icon",b);N(d,0==a.oB);N(e,2==a.oB);N(f,1==a.oB);d="";switch(a.oB){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&T(c,d);this.yb.appendChild(c,b)};function yzc(a){var b=a.type;if(!q(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":b=[];for(var c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return q(a.value)?a.value:null}}
function zzc(a,b){var c=a.type;if(q(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(na(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":na(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};function Azc(a,b,c,d){P.call(this,d);this.F=new Us("",new yY,this.Da());this.Ya(this.F);this.V=new hX(!1,"#4285f4");this.Ya(this.V);this.J=new dZ;this.J.DKa=!0;this.J.Sa=!0;this.Ea(this.J);this.O=b;this.O.J=this.J;b=new gI(null,new xzc(d));this.D=new eI(this.O,b,this.J);this.Ea(this.D);this.Mb=a;this.L=!1;this.va=ij(new hj,c).build();this.H=this.xc=this.C=this.$=null}ia(Azc,P);p=Azc.prototype;
p.Ua=function(){P.prototype.Ua.call(this);var a=this.D.ze();a.className="waffle-assistant-answers-ac-renderer";a.YO="waffle-assistant-answers-ac-row";a.w8="waffle-assistant-answers-ac-active";a.csa="waffle-assistant-answers-ac-highlighted";this.J.C=this.D;this.D.u_=!1;this.D.Ida=6;this.getHandler().R(this.D,"update",this.spb)};
p.Ad=function(a){P.prototype.Ad.call(this,a);var b=this.Da();this.xc=a;this.H=b.fb("waffle-assistant-answers-query-box",a);this.F.rb(b.fb("waffle-assistant-answers-clear-query-button",this.H));this.$=b.fb("waffle-assistant-answers-spinner-container",this.H);this.V.render(this.$);this.C=b.fb("waffle-assistant-answers-input-box",this.H);rjb(this.J,this.C);zY(this.F.getElement(),"Clear query");Bzc(this,this.getHandler());this.F.setVisible(!1)};p.Oa=function(){P.prototype.Oa.call(this);this.O.J=null};
p.setVisible=function(a){this.xc&&(N(this.xc,a),(a=Gv)&&a.dispatchEvent("resize"))};function Czc(a,b,c){c=void 0===c?!1:c;zzc(a.C,b);c&&a.C.focus();a.u_a()}function Bzc(a,b){b.R(a.H,"submit",a.UNb).R(a.H,"focus",function(){return Dzc(a,!0)},!0).R(a.H,"blur",function(){return Dzc(a,!1)},!0).R(a.F,"action",a.a$a).R(a.C,"input",a.u_a).R(a.C,"focus",a.SWa)}
p.spb=function(a){a.row&&(a=a.row,2==a.oB?(Ezc(this,1,a.rxa,a.txa,a.gp,2),this.Mb.mc(2652,this.va)):0==a.oB?(this.L=!0,this.Mb.mc(2651,this.va)):1==a.oB&&Ezc(this,3))};function Dzc(a,b){tq(a.H,"waffle-assistant-answers-query-box-focused",b);a.D.dg()&&!b&&a.D.Ki()}p.u_a=function(){this.F.setVisible(!!yzc(this.C))};p.SWa=function(){this.D.Qw(this.C);var a=eb(yzc(this.C));this.J.V4(a.length);cjb(this.D,a||"  ");this.D.update(!0)};p.UNb=function(a){a.stopPropagation();a.preventDefault();Ezc(this,2)};
function Ezc(a,b,c,d,e,f){c=void 0===c?null:c;d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;var h=Ta(yzc(a.C));a.F.setVisible(!!h);Fzc(a);a.dispatchEvent(new czc(b,h,a.L,c,d,e,f));a.L=!1}p.a$a=function(){zzc(this.C,"");this.F.setVisible(!1)};function Gzc(a,b){N(a.$,b);N(a.Da().fb("waffle-assistant-answers-button-container",a.H),!b);a.V.setActive(b)}function Fzc(a){a.C.blur();a.D.dg()&&a.D.Ki()};function Hzc(a){return W('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+V(izc({OO:a.MJa.OO}))+V(gzc({error:a.MJa.error,showHelp:a.showHelp}))+"</div></div>")}function Izc(){return W('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function eZ(a,b,c,d,e){BY.call(this,new vw,e);this.H=a;this.va=b;this.L=d;this.Ia=c;this.J=new Us("",new yY,this.Da());this.Ya(this.J);this.C=new Us("",new xY,this.Da());this.Ya(this.C);this.F=new Us("",new xY,this.Da());this.Ya(this.F)}u(eZ,BY);p=eZ.prototype;p.cF=function(){Bq(this.Qa,"Error Card for question: "+this.H.D)};p.UC=n("assistantAnswersFeedback");p.hF=ld;p.yca=kd;p.Ka=function(){eZ.ea.Ka.call(this);cxc(this).appendChild(U(jzc))};
p.Ua=function(){eZ.ea.Ua.call(this);var a=this.fb("waffle-assistant-answers-card-remove");this.J.rb(a);this.F.setVisible(this.L);zY(a,"Remove card",0);this.getHandler().Mc(this.J,"action",this.G4b).Mc(this.C,"action",this.XFb).R(this.F,"action",this.F4b)};
p.iF=function(a){CY(this).appendChild(U(Hzc,{MJa:Qyc(this.H),showHelp:this.L}));if(Pn){var b=U(Izc);this.Da().appendChild(this.Qa,b);this.C.rb(this.fb("waffle-assistant-answercard-feedback-link"))}this.L&&this.F.rb(this.fb("waffle-assistant-answers-helpcenter-link"));a()};p.goa=g("va");p.PP=g("H");p.XFb=function(){this.C.setVisible(!1);N(this.fb("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new G("trigger_feedback"))};p.G4b=function(){azc(this.Ia,!1);this.dispatchEvent(new G("rc"))};
p.F4b=function(){Q.Uo.Dc()};function Jzc(a){BY.call(this,new vw,a);this.C=this.Da().createElement("div");qn(this.C,"Previous")}u(Jzc,BY);p=Jzc.prototype;p.cF=function(){Bq(this.Qa,"Previous questions below")};p.Ka=function(){Jzc.ea.Ka.call(this);rq(this.Qa,"waffle-assistant-card");T(this.Qa,"waffle-assistant-answers-previousheadercard")};p.iF=function(a){0<this.Da().Bi(CY(this)).length||CY(this).appendChild(this.C);a()};p.yca=kd;p.UC=n("assistantAnswersFeedback");function Kzc(a){var b=""+((a.G$?V(gzc({error:a.G$,showHelp:a.showHelp})):"")+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+V(a.title)+"</div>":""));var c=Pr("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.pB;for(var d=a.length,e=0;e<d;e++){var f=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+X(c)+'">'+V(du({icon:"docs-icon-img docs-icon-help"}))+
'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+V(f)+"</div></div></div>"}return W(b+"</div>")};function fZ(a,b,c,d,e,f){BY.call(this,a,f);this.C=e||null;this.va=b;this.F=d;this.Ia=c;this.L=this.C?5==this.C.error:!1;this.H=new Us("",new xY,this.Da());this.Ya(this.H);this.J=new Us("",new yY,this.Da());this.Ya(this.J)}u(fZ,BY);p=fZ.prototype;p.Ka=function(){fZ.ea.Ka.call(this);this.hF()&&cxc(this).appendChild(U(jzc))};
p.Ua=function(){fZ.ea.Ua.call(this);T(this.Qa,"waffle-assistant-answers-suggestioncard");this.H.setVisible(this.L);this.getHandler().R(this.H,"action",this.H4b);if(this.hF()){var a=this.fb("waffle-assistant-answers-card-remove");this.J.rb(a);zY(a,"Remove card",0);this.getHandler().Mc(this.J,"action",this.I4b)}};p.rH=function(){return yb([Lzc,gZ],this.F)?2799:yb([Mzc,Nzc],this.F)?2801:null};p.qH=function(){return yb([Lzc,gZ],this.F)?2798:yb([Mzc,Nzc],this.F)?2800:null};p.Kaa=n("Were these interesting?");
p.dpa=n("Interesting");p.cpa=n("Not interesting");p.UC=n("assistantAnswersFeedback");p.hF=function(){return this.C?!Lyc(this.C):!1};p.cF=function(){var a=this.F.title;a&&this.C?Bq(this.Qa,a+(" for question : "+this.C.D)):Bq(this.Qa,"Suggested questions")};
p.iF=function(a){var b=this;this.Ia.then(function(c){if(b.jc()){if(0==c.length)N(b.Qa,!1);else{var d=b.Da(),e=CY(b);if(0==d.Bi(e).length){var f=U(Kzc,{title:b.F.title,pB:sb(c,function(a){return a.query}),G$:b.C?Ryc(b.C):"",showHelp:b.L});e.appendChild(f);var h=sb(c,function(a){return a.type});e=b.aj("waffle-assistant-answercard-question-container");x(e,function(a,e){var f=new Us("",new yY,d);b.Ya(f);f.rb(a);b.getHandler().R(f,"action",t(b.OHb,b,c[e],h,e))});b.L&&b.H.rb(b.fb("waffle-assistant-answers-helpcenter-link"))}}a()}})};
p.I4b=function(){azc(this.va,!1);this.dispatchEvent(new G("rc"))};p.OHb=function(a,b,c){this.dispatchEvent(new bzc(this.F.s5,a.gp||null,b,c,this.F.K_,a.query))};p.H4b=function(){Q.Uo.Dc()};var Ozc={title:"",K_:0,s5:null},Lzc={title:"",K_:5,s5:1},gZ={title:"Suggested questions",K_:5,s5:1},Nzc={title:"Did you mean?",K_:2,s5:4},Mzc={title:"Related questions",K_:4,s5:4};function Pzc(){var a=Pr("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<input type="text" class="waffle-assistant-answers-input-box" placeholder="'+X(a)+'" aria-label="'+X(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');a+='<div class="'+X("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+
'">'+V(du({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return W(a)};function hZ(a,b,c,d,e,f,h,k,l,m,r,v,w){GY.call(this,w);this.Zd=c;this.Ed=d;this.Ze=e;this.kc=a;this.kb=new xyc(this.Ed);this.eb=h;this.La=m;this.uf=r;this.Fe=v;this.L=this.D=this.Gb=this.F=null;this.Sb="";this.va=new qzc;this.Mb=f;this.Ia=this.Yb=this.Sa=this.H=null;this.Za=k;this.Bd=!1;this.Cb=ij(new hj,10).build();this.ad=new ch;this.sb=l;this.V={};this.Yc=Zh();this.ob="";this.$=null}u(hZ,GY);p=hZ.prototype;p.Ua=function(){hZ.ea.Ua.call(this);this.iJ(!this.H)};
p.Eva=function(a,b){hZ.ea.Eva.call(this,a,b);b=this.Da();var c=this.O,d=U(Pzc);b.appendChild(a,d);this.D=new Azc(this.Mb,this.va,10,b);c.Ya(this.D);this.D.rb(d);c.getHandler().R(this.D,"answers-submit-query",t(this.C4b,this))};p.K9=function(){hZ.ea.K9.call(this);this.D=null};p.iJ=function(a){var b=this;this.D&&this.D.setVisible(!a);a?(this.$&&this.$.dispose(),this.$=new jl(function(){hZ.ea.iJ.call(b,a)},300,this),this.Ea(this.$),this.$.start()):(this.$&&this.$.stop(),hZ.ea.iJ.call(this,a))};
p.eg=ca("Gb");
function Qzc(a,b,c,d,e,f,h){h=h?h:[];a.kb.Ne(c,b,d,e,h);h=sb(Ac(c,1),function(a){return a.getName()});var k=[],l=[];x(Ac(c,2),function(a){k.push(a.getName());l=l.concat(Ac(a,2))});rzc(a.va,h,k,l);a.kc.Xda().then(function(a){this.va.F=a;this.D&&(a=this.D,Fn(a.Da())==a.C&&a.SWa())},null,a);a.H=b;a.Sa=d;a.Yb=e;a.Ia=c;a.Cb=jj(ij(new hj,10),Rzc(a)).build();if(f&&Zn)for(c=sb(a.C,function(a){if(a instanceof bZ||a instanceof eZ)return a.PP().D}),a.O_(),d=0;d<c.length;d++)if(e=c[d])f=new mY,M(f,1,5),Szc(a,
e,f);a.iJ(!b)}p.reset=function(){KV(this.V);KV(this.va.D);var a=this.va;a.F=[];a.C.clear();this.L=null;this.mHa()};
function Szc(a,b,c,d,e){d=void 0===d?null:d;e=void 0===e?!1:e;var f=a.La.L.fw();M(c,13,f);f=new nY;Ti(f,5,c);Fzc(a.D);if(!a.Gb||3<=a.Gb.getStatus().getState().C)if(a.V[b])Tzc(a,b,!1);else{d=new YY(b,null,null,null,2,a.La);Uzc(a,d,!0,f);return}else{var h=a.V[b];h&&h instanceof eZ&&2==h.PP().error&&delete a.V[b]}if(b&&a.H)if(a.V[b])a.Mb.mc(2681,a.Cb),Tzc(a,b,!0);else{h=Rzc(a);var k=Ri(Ri(h,jV,46),nY,4);M(k,2,e);e=jj(ij(new hj,10),h).build();a.Mb.mc(2635,e);e=nx(a.H.rect);b=Al(Ak(Bl(Ck(Dk(a.Gb.nf("/answers/parse").Zf("q",
b,"qt",L(c,1),"gid",a.H.Zc,"range",e,"context",a.Sb),t(a.Vk,a,b,f)),t(a.B4b,a,b,f)),"POST"),2));Zn&&a.Sa&&null!=a.Yb&&(c=0==a.Sa.rect.width||0==a.Sa.rect.height?"":nx(a.Sa.rect),b.Zf("headerRange",c,"tableRecordDimension",""+a.Yb));d&&b.Zf("sgfml",d);b.Ke();a.ob=$h(a.Yc,gk.lza);Gzc(a.D,!0)}else Czc(a.D,"")}function Tzc(a,b,c){var d=a.V[b];d!=ob(a.C)&&(1<a.C.length&&Vzc(a),c&&Wzc(a,d.PP()).then(function(a){Xzc(this,d,a)},null,a),Hxc(a,d))}
p.C4b=function(a){var b=a.C;var c=a.Ia;var d=a.J,e=a.$;c?c=Fyc(b,d,e,c):(c=new mY,M(c,1,b));Szc(this,a.V,c,a.F,a.L)};p.B4b=function(a,b){if(this.H){var c=L(Ri(b,mY,5),1);c=1==c||4==c?twc.LDa:twc.jEa;var d=Rzc(this),e=Ri(Ri(d,jV,46),nY,4);M(e,1,c);M(b,1,c);c=jj(ij(new hj,10),d).build();this.Mb.mc(2640,c);Yzc(this,a,b)}};function Yzc(a,b,c){Gzc(a.D,!1);b=new YY(b,null,null,null,3,a.La);Uzc(a,b,!1,c);Zzc(a)}
p.Vk=function(a,b,c){this.H&&this.Za.C.D.$d.then(function(){var d=null,e=null,f=!1,h=Ri(b,mY,5),k=L(h,1),l=Rzc(this);k=1==k||4==k?twc.LDa:twc.jEa;var m=Ri(Ri(l,jV,46),nY,4);M(m,1,k);M(b,1,k);l=jj(ij(new hj,10),l).build();if(c.Wl()){e=this.ad.Qc(qY.Ra(),c.Ff());if(f=e.getStatus()){switch(f){case 1:var r=2639;break;case 2:r=2643;break;case 3:r=2644;break;case 4:r=2638;break;case 5:r=2707;break;case 6:r=2706}r&&this.Mb.mc(r,l)}r=B(e,10);M(h,4,r);r=B(e,11);M(h,5,r);vc(e,16)&&(r=B(e,16),M(h,16,r));if(1==
f){Yzc(this,a,b);return}if(2==f){e=-1!=$zc(a);h=-1!=Eyc(a);f=4;d=Ri(b,mY,5);e?(f=5,M(d,8,2)):h&&(f=7,M(d,8,1));h=new YY(a,null,null,null,f,this.La);e?(e=new eZ(h,!0,this.sb,!0,this.Da()),aAc(this,h,e,b)):Uzc(this,h,!0,b);Gzc(this.D,!1);Zzc(this);return}r=vc(e,2)?B(e,2):null;f=!0;if(r){k="";d=tyc(this.Za,r,this.H,!!this.Ia&&!!B(this.Ia,4));M(h,14,!!d);if(!d){if(m=r.match(/([A-Z]*)\(/)){var v=Ri(Ri(kma(l),jV,46),nY,4);M(v,7,m[1]);M(b,7,m[1])}this.Mb.mc(2645,l)}d&&uyc(d)||(l=this.Za,v=this.H,k="="!=
r[0]?"="+r:r,m=bAc(l),v=cAc(m,v),k=KDb(l.C,k,m,v.row,v.Mj));l=vc(e,19)?tyc(this.Za,B(e,19)||"",this.H,!!this.Ia&&!!B(this.Ia,4)):d;d=new YY(a,d,"="!=r[0]?"="+r:r,e,null,this.La,l);vc(e,23)&&d.Rl()?this.Sb=Bc(e,23):this.Sb="";k&&d.L.push(k);d.Rl()&&Ti(h,15,d.V)}else vc(e,9)&&(r=e.getError(),d=new YY(a,null,null,e||null,6,this.La),l=B(r,2),M(h,6,l),vc(r,3)&&(r=B(r,3),M(h,12,r)))}else this.Mb.mc(2640,l);d||(d=new YY(a,null,null,e||null,4,this.La));Gzc(this.D,!1);Lyc(d)?dAc(this,d,f,b):Uzc(this,d,f,b);
Zzc(this)},function(){Yzc(this,a,b)},this)};function Zzc(a){""!=a.ob&&(ai(a.Yc,a.ob),a.ob="")}function eAc(a){if(null!=a.gp)return Mzc;switch(a.error){case 4:case 6:return 0<a.O.length?Nzc:gZ;case 5:return gZ}return Ozc}function Rzc(a){var b=new nY;M(b,8,tva);var c=new jV;Ti(c,4,b);a=lxc(a.H);Ti(a,46,c);return a}function $zc(a){return xb(Cyc,function(b){return Na(a,b)})}
function fAc(a,b){var c=[];b=b.O;for(var d=0;d<b.length&&3>c.length;++d){var e=B(b[d],2),f=!!a.Ia&&!!B(a.Ia,4);e=tyc(a.Za,e,a.H,f);uyc(e)&&(e={query:B(b[d],1),gp:B(b[d],2),type:b[d].getType()},vc(b[d],5)&&(e.AKa=B(b[d],5)),c.push(e))}return qj(c)}function dAc(a,b,c,d){c=new bZ(b,a.Zd,a.Ed,a.Ze,a.Mb,a.sb,a.eb,c,0,a.Bd,a.Da());aAc(a,b,c,d)}
function gAc(a,b,c){if(a.F&&a.F.pb())RK(a.F);else{var d=a.uf.D.C["ritz-ap"]||null;c.Ifa()&&(a.F=TK(a.Fe,a.Da(),d,void 0,"answersChartsPromo"),a.F&&(a.F.show(),a.Ea(a.F),a.getHandler().Mc(a,"Ae",a.mHa)));b.Rl()&&F2a(d,"answersChartsPromo")}}p.Oga=function(){hZ.ea.Oga.call(this);this.F&&this.F.pb()&&this.F.C.zd()};p.mHa=function(){this.F&&this.F.pb()&&RK(this.F)};function Uzc(a,b,c,d){c=new eZ(b,c,a.sb,!1,a.Da());aAc(a,b,c,d)}
function aAc(a,b,c,d){Vzc(a);var e=Wzc(a,b,d);hAc(a,c);c instanceof bZ&&gAc(a,b,c);iAc(a);Lyc(b)&&szc(a.va,b.D);e.then(function(a){if(d){var b=Rzc(this),e=Ri(b,jV,46);Ti(e,4,d);b=jj(ij(new hj,10),b).build();this.Mb.mc(2781,b)}Xzc(this,c,a)},null,a);c.goa()&&(a.V[b.D]=c);a.getHandler().R(c,"rc",a.aQa)}function Xzc(a,b,c){b instanceof eZ&&c&&lp(c.getElement())&&(b=b.getElement(),N(b,!1),a.getHandler().R(c,"rc",a.aQa))}
function Vzc(a){jAc(a);x(a.C,function(a){a instanceof eZ&&(a=a.getElement(),N(a,!0))});kAc(a)}function kAc(a){0!=a.C.length&&(a.L?Hxc(a,a.L):(a.L=new Jzc(a.Da()),hAc(a,a.L)))}function jAc(a){x(a.C,function(b){b instanceof bZ||b instanceof eZ||b==a.L||a.XI(b)})}function lAc(a,b){var c=qj([]);b=b.Ia;0<b.length&&(c=Ayc(a.kb,b));return c=c.then(function(b){var c=3-b.length;return 0<c?jyc(a.kc,c).then(function(a){return Ib(b,a)}):qj(b)})}
function Wzc(a,b,c){var d=eAc(b),e=null;d==Mzc||d==Nzc?0<b.O.length&&(e=fAc(a,b)):d==gZ&&(e=lAc(a,b));var f=null;return e?(f=new fZ(new vw,a.sb,e,d,b,a.Da()),hAc(a,f),a.Mb.mc(2769,a.Cb),a.getHandler().R(f,"sqc",t(a.NHb,a)),e.then(function(a){if(c){var b=Ri(c,mY,5);yb([Mzc,Nzc],f.F)?(a=Hyc(a),Ti(b,7,a)):yb([Lzc,gZ],f.F)&&(a=Iyc(a),Ti(b,9,a))}return f},null,a)):qj(f)}p.NHb=function(a){Czc(this.D,a.F,!0);var b=a.V;b=1==b?Fyc(b,a.C,a.J,3):Gyc(b,a.C,a.J,a.$);Szc(this,a.F,b,a.L);this.Mb.mc(2762,this.Cb)};
function hAc(a,b){b.ef(a.Hd());a.C.push(b);if(a.$e){Gxc(a,!1);var c=a.J.ld();b.O=c;a.J.Lh(b,0,!0);b.BL()}exc(b,!0)}function iAc(a){for(var b=a.C;5<b.length;)a.XI(b[0])}p.O_=function(){hZ.ea.O_.call(this);this.reset()};
p.aQa=function(a){var b=this,c=this.Da();a=a.target;if(a instanceof bZ)this.XI(a),cZ(this.eb,"Answer removed",c,t(this.GEb,this,a));else if(a instanceof eZ)this.XI(a),cZ(this.eb,"Card removed",c);else if(a instanceof fZ&&a.C&&!Lyc(a.C)){var d=a.C.D;x(this.C,function(a){a instanceof eZ&&a.PP().D==d&&(b.XI(a),cZ(b.eb,"Card removed",c))})}a=this.C;!this.L||a[0]!=this.L&&a[a.length-1]!=this.L||(this.XI(this.L),this.L=null)};
p.GEb=function(a){dAc(this,a.PP(),a.goa());cZ(this.eb,"Remove answer undone",this.Da())};p.XI=function(a){if(a.jc()){if(a instanceof bZ||a instanceof eZ)delete this.V[a.PP().D],a==ob(this.C)&&jAc(this);hZ.ea.XI.call(this,a)}F(a)};function mAc(a,b){this.C=a;this.D=b}function tyc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=bAc(a);c=cAc(e,c);(a=bwc(a.C,b,e,c.row,c.Mj))&&d&&a.length<a[0].length&&(a=Rxc(a));return a}function uyc(a){if(a)for(var b=1<a.length?1:0;b<a.length;b++){for(var c=!1,d=a[b],e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1}function bAc(a){a=Aw(a.D);return null!=a?a.toString():"0"}
function cAc(a,b){var c={row:0,Mj:0};ritz_api.RitzModelApi.getActiveFilterId(a)&&b&&(b=b.rect,ritz_api.RitzModelApi.getNumberOfRows(a)>b.Pc()+1?c.row=b.Pc()+1:ritz_api.RitzModelApi.getNumberOfColumns(a)>b.Uc()+1&&(c.Mj=b.Uc()+1));return c};function nAc(){var a=""+(W('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
V(du({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+Tr("Ask a question about your data")+'"/></div></form></div>');return W(a)};function iZ(a,b,c,d,e,f,h,k,l,m){HY.call(this,1,f,e,m);this.Cb=c;this.La=null;this.va=new Us("",new xY,this.Da());this.Ya(this.va);this.Sa=new Us("",new xY,this.Da());this.Ya(this.Sa);a=new NDb(a,!0,!0);a=new mAc(a,c);this.ob=new $yc(e);this.O=new pyc(this.Cb,a,e);this.L=new hZ(this.O,0,b,c,d,e,this.kb,a,this.ob,h,k,l,m);c=oAc;this.D=new dzc(b,c.K3a,c.L3a);this.Ea(this.D);this.F=this.H=null;this.sb=ij(new hj,10).build();this.Ia=!1}u(iZ,HY);
var oAc={K3a:"waffle-assistant-answers-styled-border",L3a:"waffle-assistant-answers-styled-rect",W3a:"waffle-assistant-answers-input-box",r5a:"waffle-assistant-answers-query-box",Axc:"waffle-assistant-answers-query-box-focused",l4a:"waffle-assistant-answers-learn-more",tsc:"waffle-assistant-answers-logging-message-container",W4a:"waffle-assistant-answers-logging-opt-out"};p=iZ.prototype;p.Ka=function(){iZ.ea.Ka.call(this);var a=U(nAc);this.Da().appendChild(Jxc(this),a)};
p.Ua=function(){iZ.ea.Ua.call(this);var a=oAc,b=this.fb(a.r5a),c=this.fb(a.W3a);this.Sa.rb(this.fb(a.W4a));this.va.rb(this.fb(a.l4a));this.getHandler().R(b,"focus",this.RDb,!0).R(b,"blur",this.PDb,!0).R(b,"mouseover",this.TDb).R(b,"mouseout",this.SDb).R(b,"click",this.QDb).R(c,"input",this.D4b).R(this.Sa,"action",this.iCb).R(this.va,"action",this.Oyb).R(Lw(this.Cb),"Fa",Coc(this.E4b,25,this));this.setVisible(!!this.H);pAc(this,$ua&&cva&&$n("showAnswersLoggingOptOut"))};p.AYa=kd;p.QQa=ld;p.Jwa=kd;
p.rX=n("Answers");p.Nga=n(1);p.Y8=function(a){return 3==a||0==a};p.d6=function(a,b){Qb(a,function(a,b){return B(b,2)-B(a,2)});for(var c=[],d=null,e=0;e<a.length;e++){var f=Bc(a[e],1);3==f?d=a[e]:0==f&&c.push(B(a[e],8))}if(d&&B(d,2)){e=b||null;f=vc(d,11)?B(d,11):null;var h=null==f?null:aV(B(d,10));0<wc(d,4)?qAc(this,aV(fV(d)),B(d,9),h,f,c):qAc(this,e,B(d,9),h,f,c);this.F||(iZ.ea.d6.call(this,a,b),this.getHandler().R(this.F,"sqc",this.MHb))}else this.qX(!0)};
p.Z_=function(a){if(!this.F){var b=jyc(this.O,3);this.F=new fZ(a,this.ob,b,Lzc,void 0,this.Da())}return this.F};p.HGa=g("L");p.Ura=function(){return this.pb()};
p.qX=function(a,b,c){this.O.reset();(a||b)&&this.F&&(iZ.ea.qX.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||q(b)&&!b)this.F&&(iZ.ea.qX.call(this,a,b,c),this.F.dispose(),this.F=null),this.jc()&&(this.O.reset(),this.H=null,a=this.L,a.jc()&&(b=a.va,b.F=[],b.C.clear(),a.D&&(b=a.D,b.jc()&&(b.C&&zzc(b.C),b.F.isDisposed()||b.F.setVisible(!1),b.L=!1)),a.O_(),a.kb.reset(),a.H=null,a.iJ(!0)),this.setVisible(!1),this.gc()&&$Y(this.D));c&&this.L.reset()};p.eg=function(a){this.La=a;this.L.eg(a);this.O.eg(a)};
p.setActive=function(a){iZ.ea.setActive.call(this,a);a?ZY(this.D,this.H):$Y(this.D)};function rAc(a,b){a.gc()&&(b?$Y(a.D):ZY(a.D,a.H))}function pAc(a,b){N(a.fb("waffle-assistant-answers-logging-message-container"),b)}function sAc(a,b){a=a.fb("waffle-assistant-answers-query-box");tq(a,"waffle-assistant-answers-query-box-focused",b)}p.E4b=function(){this.gc()&&ZY(this.D,this.H)};p.RDb=function(){sAc(this,!0);ZY(this.D,this.H)};p.PDb=function(){sAc(this,!1);this.gc()||$Y(this.D)};
p.TDb=function(){ZY(this.D,this.H)};p.SDb=function(){this.gc()||$Y(this.D)};p.QDb=function(){tAc(this,"")};p.D4b=function(){var a=this.fb("waffle-assistant-answers-input-box");tAc(this,a.value);a.value=""};p.MHb=function(a){var b=this,c=a.F;tAc(this,c);var d=Fyc(1,a.C,a.J,1),e=new jl(function(){Szc(b.L,c,d,a.L)},300);this.Ea(e);e.start();this.ct().mc(2652,this.sb)};
function tAc(a,b,c){a.setActive(!0);a.dispatchEvent("Fe");var d=new jl(function(){Czc(a.L.D,b,!0);var d=a.L,f=c||!1;d.Bd=f;d.kc.$=f;d.kb.$=f},300);a.Ea(d);d.start()}function qAc(a,b,c,d,e,f){c=c||new sw;a.H=b;a.O.Ne(c,b,d,e,f);a.O.Wda();a.setVisible(!!b);Qzc(a.L,b,c,d,e,a.Ia,f);a.Ia=!1;a.gc()&&ZY(a.D,a.H)}p.iCb=function(a){a.stopPropagation();a.preventDefault();this.La&&(Bl(Ck(Dk(this.La.nf("/answers/logoptout"),t(this.Azb,this)),t(this.zzb,this)),"POST").Ke(),this.ct().mc(2663,this.sb))};
p.Oyb=function(a){a.stopPropagation();a.preventDefault();ct("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};p.Azb=function(a){a.Wl()&&pAc(this,!1)};p.zzb=ba();function uAc(a,b,c){H.call(this);this.C=GLa(FLa.getInstance(),a,b,c);this.D=al()}u(uAc,H);uAc.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!wb(c,function(a){return Dda(a,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].Nh()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&HLa(this.C),this.D=vAc(),this.D.addCallback(function(){return JLa(d.C,b)}))};uAc.prototype.eg=function(a){this.C.eg(a)};
function vAc(){var a=null,b=new Uk(function(){null===a||zj(a)});a=yj(function(){b.dc()});return b};function wAc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+X(a.title)+'">'+V(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+Tr("Press enter to insert formula")+'"></span></div>');return W(a)};function jZ(a,b){P.call(this);this.C=a;this.D=b}u(jZ,P);p=jZ.prototype;p.Ka=function(){this.Qa=U(wAc,{name:this.C,title:this.D})};p.Ua=function(){jZ.ea.Ua.call(this);var a=this.fb("waffle-assistant-quicksum-entry-name");zY(a);this.getHandler().R(this.Qa,"keypress",this.l4b);N(this.Qa,!1)};p.getFunctionName=g("C");p.jb=function(a){qn(this.fb("waffle-assistant-quicksum-entry-value"),a||"");N(this.Qa,!!a)};p.pb=function(){return lp(this.Qa)};
p.l4b=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new G("insert",this)))};function kZ(a,b,c,d,e){P.call(this,e);this.Sa=a;this.Ia=b;this.L=c;this.Mb=d;this.D=a.C;this.La=new ch;this.V=ij(new hj,17).build();this.O=ij(new hj,2).build();this.J=!1;this.F=[];this.C=null;this.H=[]}u(kZ,P);
kZ.prototype.Ua=function(){kZ.ea.Ua.call(this);this.Lh(new jZ(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Lh(new jZ(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Lh(new jZ(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Lh(new jZ(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Lh(new jZ(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new aZ(this.Qa,
this.Ia,this.D,this.L);this.C.ef(this.J);this.Ea(this.C);this.getHandler().R(this,"insert",this.$).R(this.C,"formula_inserted",this.va)};
function xAc(a){function b(a){return l?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,m):null}if(Uw(a.D)){var c=Bw(a.D),d=c.gk(),e=bE(a.D);if(vb(d,c.Yt,c)){c=[];a.F=[];for(var f=0;f<d.length;f++){var h=d[f],k=dh(e+"",h.yc(),h.wc(),h.Pc(),h.Uc());c.push(a.La.serialize(k));a.F.push(h)}if(d=ritz_api.RitzModelApi.quickSum(c)){N(a.Qa,!0);e=d.count;c=d.countNumberFormat;var l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.qd(0).jb(b(d.sum));a.qd(1).jb(b(d.average));a.qd(2).jb(b(d.min));a.qd(3).jb(b(d.max));
1<e?a.qd(4).jb(ritz_api.RitzModelApi.renderNumberAsFormattedString(e,c)):N(a.Qa,!1);if(a.C){a.C.J=[];a.H=[];for(d=0;d<a.ld();++d)e=a.qd(d),a.H.push(yAc(a,e.getFunctionName()));a.C.J=a.H}}else N(a.Qa,!1)}else N(a.Qa,!1)}else N(a.Qa,!1)}kZ.prototype.ef=function(a){this.J=a;this.C&&this.C.ef(a);tq(this.Qa,"waffle-assistant-quicksum-panel-readonly",a)};
kZ.prototype.$=function(a){var b=a.target;a=this.F[0];a=new Rd(a.left,a.Pc());b=b.getFunctionName();b=yAc(this,b);a=new WH(Bw(this.D),a,b);this.L.C(a);this.Mb.mc(2624,this.O)};kZ.prototype.va=function(){this.Mb.mc(2624,this.V)};function yAc(a,b){var c=hNa(a.Sa.L);a=sb(a.F,function(a){return nx(a)});return"="+b+"("+a.join(c)+")"};function zAc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+V(at({content:Pr("INSERT CHART"),style:4,Ce:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+V(at({Ce:"waffle-autovis-lightbox-close",content:Qr(""+V(du({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:Pr("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">'+
V(at({content:Qr("&#10094;"),style:4,Ce:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:Rr('aria-label="'+Tr("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+V(at({content:Qr("&#10095;"),style:4,Ce:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:Rr('aria-label="'+Tr("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
V(a.pPb)+"</div></div></div>");return W(a)}function AAc(){return W('<div class="waffle-autovis-lightbox-chart"></div>')};function lZ(a,b,c,d){P.call(this,d);this.F=a;this.D=b;this.Mb=c;this.H=[];this.C=new bt("",this.Da());this.Ya(this.C);this.O=new bt("",this.Da());this.Ya(this.O);this.L=new bt("",this.Da());this.Ya(this.L);this.J=new bt("",this.Da());this.Ya(this.J)}u(lZ,P);p=lZ.prototype;p.Ka=function(){lZ.ea.Ka.call(this);this.Qa=U(zAc,{pPb:this.F.length})};
p.Ua=function(){lZ.ea.Ua.call(this);var a=R.WP.isEnabled();this.ef(!a);a=this.fb("waffle-autovis-lightbox-close");this.C.rb(a);a=this.fb("waffle-autovis-lightbox-insert");this.O.rb(a);var b=this.fb("waffle-autovis-lightbox-previous");this.L.rb(b);b=this.fb("waffle-autovis-lightbox-next");this.J.rb(b);BAc(this);CAc(this,this.D,!1);this.getHandler().R(document.body,Uba,this.j0b).R(this.Qa,"keydown",this.k0b).R(Xm(),"resize",this.n0b).R(this.C,"action",this.close).R(this.O,"action",this.fyb).R(this.L,
"action",this.m0b).R(this.J,"action",this.l0b);b=new GI(this.Qa,this.Da());HI(b);this.Ea(b);a.focus()};function BAc(a){var b=a.fb("waffle-autovis-lightbox-content"),c=a.fb("waffle-autovis-lightbox-content-inner");a=a.fb("waffle-autovis-lightbox-page-count");var d=Vm();a=ip(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;fp(c,d,e);fp(b,d,e+a.height+35)}p.ef=function(a){tq(this.Qa,"waffle-autovis-lightbox-readonly",a)};
function CAc(a,b,c){c&&Fo("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?DAc(a,b):a.F[b]&&pxc(a.F[b],t(a.Zqb,a,b),!0)}p.Zqb=function(a,b){if(!this.isDisposed()&&b){var c=this.fb("waffle-autovis-lightbox-container"),d=U(AAc);c.appendChild(d);this.H[a]=d;$W(b,d,this.Mb,Vn);DAc(this,a)}};function DAc(a,b){N(a.H[a.D],!1);N(a.H[b],!0);a.L.hb(0!=b);a.J.hb(b!=a.F.length-1);var c=a.fb("waffle-autovis-lightbox-page-number");qn(c,b+1);a.D=b}p.j0b=function(a){!on(this.Qa,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
p.k0b=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&CAc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||EAc(this);a.stopPropagation()};p.n0b=function(){var a=this.fb("waffle-autovis-lightbox-container");dn(a);this.H=[];BAc(this);CAc(this,this.D,!0)};p.fyb=function(){this.close();sxc(this.F[this.D],2256)};p.m0b=function(){0!=this.D&&CAc(this,this.D-1,!0);0==this.D&&this.J.Qa.focus()};p.l0b=function(){EAc(this);this.D==this.F.length-1&&this.L.Qa.focus()};
function EAc(a){a.D!=a.F.length-1&&CAc(a,a.D+1,!0)}p.close=function(){this.dispose()};p.yd=function(){lZ.ea.yd.call(this);var a=this.F[this.D];a&&a.Qa&&a.Qa.focus()};function mZ(a,b,c,d,e,f){cW.call(this,f);this.Ld=a;this.Zd=b.C;this.Qb=c;this.jg=d;this.Mb=e;this.gb=new kZ(b,c,d,e,this.Da());this.Ya(this.gb);this.O=new hX(!1,"#4285f4");this.Ya(this.O);this.J=null;this.Kc=this.Ac=!1;this.Yb=!0;this.Sb=Zh();this.sb=this.kb="";this.Sa=ij(new hj,10).build()}u(mZ,cW);p=mZ.prototype;p.Ka=function(){mZ.ea.Ka.call(this);this.Qa=U(FAc,{sP:Sn})};
p.Ua=function(){mZ.ea.Ua.call(this);var a=this.fb("waffle-assistant-quicksum-panel");this.gb.rb(a);a=this.fb("waffle-assistant-spinner-container");this.O.render(a);a=this.Ld.C;this.getHandler().R(this,"close-sidebar",this.Ira).R(a,"recommender-load-started",this.tra).R(a,"recommender-load-ended",this.sra).R(a,"recommender-calc-started",this.Jqa).R(a,"recommender-calc-ended",this.Iqa).R(this.fb("waffle-assistant-scroll-pane"),"scroll",Coc(this.Pga,10,this));a=R.WP.isEnabled();this.ef(!a)};
p.resize=function(){var a=this.fb("waffle-assistant-sidepane-content");a=ip(a).height;var b=this.fb("waffle-assistant-spinner-container");Ro(b,"margin-top",a/2-16+"px");this.Pga()};p.eg=sa;function GAc(a,b){var c=HAc(a);0!=c.length&&(F(a.J),c=c.filter(function(a){return a instanceof DY}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.J=new lZ(c,b,a.Mb,a.Da()),a.J.render(),a.Ea(a.J),a.J.ef(a.Kc)))}
p.ef=function(a){this.Kc=a;tq(this.Qa,"waffle-assistant-readonly",a);this.gb.ef(a);this.J&&!this.J.isDisposed()&&this.J.ef(a)};p.setVisible=function(a){var b=this.pb();mZ.ea.setVisible.call(this,a);if(a&&!b){var c=MLa(this.Ld.C,a);c?(b=new lwc,M(b,1,ue(c,"r")),M(b,2,ue(c,"c")),M(b,3,c.Nh()),c=new ej,Ti(c,4,b),b=kj(lj(this.Sa),c).build()):b=this.Sa;this.sb=$h(this.Sb,gk.HAa,!1,b);this.O.setActive(!0);nZ(this)}a||IAc(this,!0)};p.tra=function(){this.pb()&&(IAc(this,!0),this.O.setActive(!0),nZ(this))};
p.sra=function(){this.pb()&&(this.O.setActive(!1),nZ(this))};p.Jqa=function(a){this.pb()&&(this.Mb.C(2775,this.Sa),IAc(this,void 0,a.F,a.J),JAc(this)||this.O.setActive(!0),nZ(this),this.Yb=!1)};
p.Iqa=function(a){if(this.pb()){this.Mb.C(2776,this.Sa);var b=a.L;0<b.length&&(this.kb=$h(this.Sb,gk.FAa));IAc(this,!1);this.O.setActive(!1);a=a.V;for(var c=ka(this.D),d=c.next();!d.done;d=c.next()){d=d.value;for(var e=[],f=ka(b),h=f.next();!h.done;h=f.next()){h=h.value;var k=Bc(h,1);d.Y8(k)&&e.push(h)}0<e.length?d.d6(e,a):d.qX(!0)}if(Zn)for(b=ka(b),a=b.next();!a.done;a=b.next())if(a=a.value,5==Bc(a,1)){this.i9();this.Ia=B(a,12);this.$=fV(a);this.La=B(a,11);KAc(this);a=this.$;c=!1;for(d=this.Za.length-
1;0<=d;d--)e=this.Za[d],f=a,e.Ih()&&e.Pb()==f.Pb()&&jwc(eh(e),eh(f))&&jwc(fh(e),fh(f))&&(c=!0,this.Za.splice(d,1));this.Za.push(a);a=c;2!=this.Ia||a||LAc(this,!0)}b=HAc(this);0<b.length&&this.Ac&&(b[b.length-1].Gb=!0);this.Ac=!1;nZ(this);MAc(this);this.Pga()}};function nZ(a){var b=JAc(a),c=lp(a.fb("waffle-assistant-quicksum-panel")),d=a.O.gc();b=b||c||d;a=a.fb("waffle-assistant-empty-list");N(a,!b)}p.Hc=sa;p.Kva=sa;p.ct=g("Mb");p.Hd=g("Kc");p.Ira=sa;
p.ANb=function(){""!=this.kb&&(ai(this.Sb,this.kb),this.kb="");""!=this.sb&&(ai(this.Sb,this.sb),this.sb="");this.Yb||(this.Mb.mc(2777,this.Sa),this.Yb=!0)};function NAc(){var a=W;var b=""+V(at({Ce:"waffle-assistant-datavalidation-apply-button",content:Pr("Apply"),style:4}));b=W(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function OAc(a){return W('<div class="waffle-assistant-datavalidation-detail-chip">'+V(a.xab)+"</div>")};function PAc(a,b){BY.call(this,a,b);this.C=new bt("",this.Da());this.Ya(this.C)}ia(PAc,BY);p=PAc.prototype;p.Ka=function(){BY.prototype.Ka.call(this);CY(this).appendChild(U(NAc))};p.Ua=function(){BY.prototype.Ua.call(this);var a=this.fb("waffle-assistant-datavalidation-apply-button");this.C.rb(a);zY(a,"Apply data validation");this.getHandler().R(this.C,"action",this.fpb)};
p.iF=function(a){var b=nx(ih(fV(this.D))),c=B(B(this.D,13),3);switch(B(c,1)){case 14:var d="Email validation";c=["xyz@gmail.com"];break;case 15:d="URL validation";c=["www.google.com"];break;case 30:d="Date validation";c=["1970/01/01"];break;case 24:d="List of items";c=Ac(c,2).map(function(a){return B(B(a,5).bb(),2)});break;default:cwc.C("Unrecognized data validation type."),d="unrecognized",c=[]}var e=new Hv;b=e.text(d)+(" for "+(e.gf("SPAN".toString(),{oG:"waffle-assistant-datavalidation-range"})+
e.text(b)+e.kf("SPAN".toString())));Jm(this.fb("waffle-assistant-datavalidation-description"),e.format(b));var f=this.fb("waffle-assistant-datavalidation-details");x(c,function(a){a=U(OAc,{xab:a});f.appendChild(a)});a()};p.cF=ba();p.UC=n("assistantDataValidationFeedback");p.rH=n(35551);p.qH=n(35550);p.fpb=function(){this.dispatchEvent(new wY("ze",this,35549))};function QAc(a,b,c){HY.call(this,3,b,a,c)}ia(QAc,HY);p=QAc.prototype;p.rX=n("Data Validation");p.Y8=function(a){return 6==a};p.Z_=function(a){var b=B(a,1);switch(b){case 6:return new PAc(a,this.Da());default:throw Error("Unsupported recommendation type: "+b);}};p.ef=function(a){HY.prototype.ef.call(this,a);this.setVisible(!a)};p.e6=function(a){return this.Hd()?(this.setVisible(!1),a):HY.prototype.e6.call(this,a)};p.Nga=n(3);function RAc(){var a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+SAc()+"</div>");return W(a)}
function TAc(){return W('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+SAc()+"</div>")}function SAc(){var a=""+V(at({Ce:"waffle-assistant-formatting-edit-button",content:Pr("Edit"),style:4}));return W(a)};function UAc(a,b,c){BY.call(this,a,c);a=sb(Ac(this.D,7),Toc);this.C=new fW(!1,a,7);this.Ya(this.C);this.J=new bt("",this.Da());this.Ya(this.J);this.Mb=b;this.H=!1;this.F=-1}u(UAc,BY);var VAc={Bha:"waffle-assistant-banding-color-picker-container",Oha:"waffle-assistant-formatting-edit-button",sK:"waffle-assistant-banding-range"};p=UAc.prototype;p.Ka=function(){UAc.ea.Ka.call(this);CY(this).appendChild(U(RAc))};
p.Ua=function(){UAc.ea.Ua.call(this);this.getHandler().R(this.J,"action",this.Oub).R(this.C,"banding-scheme-changed",this.Kpb);this.Mb.C(2768)};p.iF=function(a){var b=this.fb(VAc.Bha);this.C.render(b);Zoc(this.C);b=this.fb(VAc.sK);var c=fV(this.D),d=ih(c);qn(b,nx(d));WAc(this,c);b=this.fb(VAc.Oha);this.J.rb(b);a()};p.cF=function(){Bq(this.Qa,"Suggested alternating background colors");Br(this.C,"Choose a color scheme")};p.UC=n("assistantBandingFeedback");p.rH=n(2672);p.qH=n(2671);
p.Oub=function(a){Do.dispatchEvent({type:"show-banding-pane-recommendation",xWa:this.D,bab:$oc(this.C)});a.stopPropagation()};p.Kpb=function(a){if(!this.H&&gW(this.C)){var b=this.F;this.F=this.C.Oh();this.F==b?this.dispatchEvent(new wY("Ee",this,2797)):this.dispatchEvent(new wY("xe",this,2673));a.stopPropagation()}};
function WAc(a,b){a.H=!0;var c=b.Pb();b=ih(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.yc(),b.wc(),b.Pc(),b.Uc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new ch).Qc(Le.Ra(),c),c=Toc(c)):c=null;c?(c=apc(a.C,c),pL(a.C,c?c.getElement():null)):pL(a.C,null);a.F=a.C.Oh();a.H=!1};function XAc(a,b){BY.call(this,a,b);this.C=new bt("",this.Da());this.Ya(this.C);this.Cb=Ac(a,6)}u(XAc,BY);var oZ={Oha:"waffle-assistant-formatting-edit-button",v3a:"waffle-assistant-conditionalformat-format-preview",O5a:"waffle-assistant-conditionalformat-rule-holder",I6:"waffle-assistant-conditionalformat-description",T4a:"one-rule",U6a:"two-rules",H6a:"three-rules",k5a:"waffle-assistant-conditionalformat-format-preview-label"};p=XAc.prototype;p.Ka=function(){XAc.ea.Ka.call(this);CY(this).appendChild(U(TAc))};
p.Ua=function(){XAc.ea.Ua.call(this);var a=this.fb(oZ.Oha);this.C.rb(a);zY(a,"Apply and edit conditional format rules");this.getHandler().R(this.C,"action",this.dpb)};p.iF=function(a){qn(this.fb(oZ.I6),Bc(this.D,3));var b=this.fb(oZ.O5a),c=new YAc(this,this.Da());this.Ya(c);c.rb(b);zY(b,"Apply conditional format rules");a()};p.cF=sa;p.UC=n("assistantConditionalFormatFeedback");p.rH=n(2630);p.qH=n(2629);
p.dpb=function(){this.dispatchEvent(new wY("ye",this,2563));this.dispatchEvent(new wY("Be",this,2670,void 0,void 0,ih(B(this.Cb[0],1,0))));Swa()};function YAc(a,b){yr.call(this,void 0,void 0,b);this.C=a}u(YAc,yr);
YAc.prototype.Ad=function(a){YAc.ea.Ad.call(this,a);var b=this.C.Cb;switch(b.length){case 0:break;case 1:var c=oZ.T4a;break;case 2:case 4:c=oZ.U6a;break;default:c=oZ.H6a}for(var d=0;d<b.length;d++){var e=b[d],f=Ym("DIV");qq(f,[oZ.v3a,c]);var h=Ym("DIV");T(h,oZ.k5a);f.appendChild(h);qn(h,"123");if(vc(e,2)){var k=B(B(e,2),1);switch(B(B(k,1),1)){case 9:case 13:k=Ac(B(k,1),2)[0];var l=Ac(e,1)[0];qn(h,HA(k,Bc(l,1),Bc(l,2),Bc(l,4)))}}eoc(e,f);a.appendChild(f)}};
YAc.prototype.Ei=function(){var a=this.C;a.dispatchEvent(new wY("ye",a,2563));return!0};function ZAc(a,b,c){HY.call(this,2,b,a,c)}u(ZAc,HY);p=ZAc.prototype;p.rX=n("Formatting");p.Y8=function(a){return 2==a||4==a};p.Z_=function(a){var b=B(a,1);switch(b){case 2:return new XAc(a,this.Da());case 4:return a=new UAc(a,this.ct(),this.Da()),this.getHandler().R(a,"xe",this.iYb).R(a,"Ee",this.DKb),a;default:throw Error("Unsupported recommendation type: "+b);}};p.iYb=function(a){cZ(this.kb,"Alternating colors applied",this.Da(),t(this.Lpb,this,a.C))};p.DKb=function(){this.kb.clear()};
p.Lpb=function(a){this.dispatchEvent(new wY("Je",a,2796))};p.ef=function(a){ZAc.ea.ef.call(this,a);this.setVisible(!a)};p.e6=function(a){return this.Hd()?(this.setVisible(!1),a):ZAc.ea.e6.call(this,a)};p.Nga=n(3);function pZ(a,b,c,d,e){P.call(this);this.O=a;this.eb=b;this.va=c;this.H=d;this.D=e}ia(pZ,P);pZ.prototype.getTableRange=g("va");pZ.prototype.Cfa=function(a,b,c){this.va=a;this.H=b;this.D=c};pZ.prototype.Ua=function(){P.prototype.Ua.call(this);this.getHandler().R(this.O.C,"M",this.gb)};pZ.prototype.gb=function(){this.eb.Dc()};function $Ac(a,b){D.call(this);this.F=a;this.H=b;this.C=new dzc(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.Ea(this.C);this.D=new dzc(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.Ea(this.D)}ia($Ac,D);$Ac.prototype.Oa=function(){$Y(this.C);$Y(this.D);D.prototype.Oa.call(this)};
function aBc(a,b,c,d,e,f){PCb(b);var h=ih(d);h=new ge(h.yc(),h.wc(),Math.min(h.Pc(),h.yc()+6),Math.min(h.Uc(),h.wc()+6));var k=z$a(b),l=mA(a.F).Yd(),m=l.Lg(new Wd(h.yc(),h.Pc()),"r",!0,!1,!0,!0)-1,r=l.Lg(new Wd(h.wc(),h.Uc()),"c",!0,!1,!0,!0)-1;l.tc()&&--r;m=Math.min(200,m);r=Math.min(c.offsetWidth-2,r);QCb(b,k,r,m);c=jxc(d,e,f);a.H.render(b,h,c);b=a.C;h=d.yc();k=d.wc();switch(e){case 0:h=Math.min(d.Pc(),d.yc()+f);break;case 1:k=Math.min(d.Uc(),d.wc()+f)}d=dh(d.Pb(),h,k,d.Pc(),d.Uc());ZY(b,aV(d));
ZY(a.D,aV(c))};function bBc(a){var b=a.PVa,c=a.OVa,d=a.nUa;a=a.FFa;return W('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+X(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+V(b)+'</div></div><div class="waffle-tables-popup-content">'+V(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+
V(d)+'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+V(a)+"</div></div></div></div>")}
function cBc(){var a=""+bBc({PVa:Pr("Edit data range"),OVa:Qr(""+W('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Data Range</label></div><div class="waffle-assistant-tables-range-error" style="display:none">Invalid range</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper">Headers<div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>')),nUa:Pr("Update"),
FFa:Pr("Cancel")});return W(a)}function dBc(){var a=""+bBc({PVa:Pr("Improve suggestions"),OVa:Qr('<div class="waffle-tables-popup-header-message"></div>'),nUa:Pr("No"),FFa:Pr("Yes")});return W(a)}function eBc(a){a='For <span class="waffle-assistant-table-bar-range">'+(V(a.mJ)+"</span>");return W(""+a)}function fBc(a){a='Is <span class="waffle-assistant-table-first-header">'+(V(a.eO)+"</span> a header row, containing titles that describe the columns below?");return W(""+a)};function qZ(a,b,c,d,e,f,h){pZ.call(this,a,R.HZ,d,e,f);this.C=(new SN).build();this.Ea(this.C);this.J=new Us("",new yY,this.Da());this.Ya(this.J);Nu(this.C,this.J,R.l8);this.F=new Us("",new yY,this.Da());this.Ya(this.F);Nu(this.C,this.F,R.HZ);this.V=new $Ac(b,c);this.Ea(this.V);this.L=new Qp(this);this.Ea(this.L);this.Ia=h}ia(qZ,pZ);qZ.prototype.Ka=function(){this.Qa=U(dBc)};
qZ.prototype.Ua=function(){pZ.prototype.Ua.call(this);this.J.rb(this.fb("waffle-tables-popup-done"));this.F.rb(this.fb("waffle-tables-popup-cancel"));var a=jxc(this.getTableRange(),this.D,1);a=nx(ih(a));a=U(fBc,{eO:a});this.fb("waffle-tables-popup-header-message").appendChild(a);this.L.subscribe(R.l8,"action",this.La).subscribe(R.HZ,"action",this.$);a=this.fb("waffle-assistant-table-canvas");var b=this.fb("waffle-assistant-canvas-container");aBc(this.V,a,b,this.getTableRange(),this.D,this.H);a=this.fb("waffle-tables-popup");
tq(a,"waffle-tables-popup-answers-enabled",this.Ia);b=new GI(a,this.Da());this.Ea(b);HI(b);a.focus()};qZ.prototype.$=function(){this.dispatchEvent("He")};qZ.prototype.La=function(){var a=ih(this.getTableRange());switch(this.D){case 0:a=pda(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=pda(a.top,a.left+1,a.top+a.height,a.left+a.width)}a=nx(a);this.dispatchEvent(new Mwc(a,this.H-1,this.D));this.dispatchEvent("He")};function gBc(a,b,c,d,e,f,h,k,l){pZ.call(this,a,R.sR,d,e,f);var m=this;this.kb=b;this.Za=d;this.Cb=e;this.Gb=f;a=ih(d);this.F=nx(a);this.Sa=new $Ac(b,c);this.Ea(this.Sa);this.C=null;this.Mb=h;this.J=(new SN).build();this.Ea(this.J);this.$=new Us("",new yY,this.Da());this.Ya(this.$);Nu(this.J,this.$,R.GZ);this.V=new Us("",new yY,this.Da());this.Ya(this.V);Nu(this.J,this.V,R.sR);this.L=new hW(this.kb,function(a,b,c){hBc(m,a,b,c)},!1,"e.g., A2:D5",!0,this.O.C.C.C,this.Da());this.Ya(this.L);this.Ia=null;
this.La=new Qp(this);this.Ea(this.La);this.ob=k;this.sb=l}ia(gBc,pZ);p=gBc.prototype;p.Ka=function(){this.Qa=U(cBc)};
p.Ua=function(){pZ.prototype.Ua.call(this);this.$.rb(this.fb("waffle-tables-popup-done"));this.V.rb(this.fb("waffle-tables-popup-cancel"));this.L.render(this.fb("waffle-assistant-tables-data-range-wrapper"));var a=this.fb("waffle-range-selection-input");yq(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().R(a,"keydown",this.XNb).R(a,"keyup",this.YNb).R(a,Vba,this.hIb).R(this.L,"change",this.ZNb);this.La.subscribe(R.GZ,"action",this.$Nb).subscribe(R.sR,"action",this.gqb);
iBc(this);a=this.fb("waffle-tables-popup");tq(a,"waffle-tables-popup-answers-enabled",this.sb);var b=new GI(a,this.Da());this.Ea(b);HI(b);a.focus()};p.Oa=function(){F(this.Ia);pZ.prototype.Oa.call(this)};function hBc(a,b,c,d){eV(a.ob,null,b,c,d,!1,void 0,function(b){a.Ia=b})}function jBc(a){var b=a.fb("waffle-assistant-table-canvas"),c=a.fb("waffle-assistant-canvas-container");aBc(a.Sa,b,c,a.getTableRange(),a.D,a.H)}p.gqb=function(){this.dispatchEvent("He")};
p.$Nb=function(){var a=!ex.test(this.F);N(this.Lb("waffle-assistant-tables-range-error"),a);tq(this.fb("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.Cb!=this.H||this.Gb!=this.D;var b=!Aoc(this.Za,this.getTableRange());if(a||b)a&&this.Mb.mc(35506),b&&this.Mb.mc(35507),this.dispatchEvent(new Mwc(this.F,this.H,this.D));this.dispatchEvent("He")}};
function iBc(a){var b=a.fb("waffle-range-selection-input"),c=ih(a.Za);a.F=nx(c);b.value=a.F;kBc(a);jBc(a)}p.Cfa=function(a,b,c){pZ.prototype.Cfa.call(this,a,b,c);jBc(this)};function lBc(a){var b=Bw(a.O.C),c=b.Bc();if(b=SMa(a.F,b))c=gh(b,c),a.Cfa(c,mBc(a,c),a.D),kBc(a)}function mBc(a,b){b=nBc(b,a.D);return a.H>b?b:a.H}function nBc(a,b){a=0==b?a.Pc()-Bc(a,2):a.Uc()-Bc(a,4);return Math.min(a-1,3)}
function kBc(a){F(a.C);a.C=new bJ;a.Ya(a.C);Nu(a.J,a.C,R.nja);hV(a.C,jW.getInstance());a.C.render(a.fb("waffle-assistant-tables-edit-headers-button"));a.getHandler().R(a.C,"action",a.bxb);for(var b=nBc(a.getTableRange(),0),c=0;c<=b;c++){var d=(new Po("{NUM_HEADER_RECORDS, plural,=0 {No rows}=1 {1 row}other {# rows}}")).format({NUM_HEADER_RECORDS:c});a.C.Nd(new ut(d))}c=nBc(a.getTableRange(),1);for(d=0;d<=c;d++){var e=(new Po("{NUM_HEADER_RECORDS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_HEADER_RECORDS:d});
a.C.Nd(new ut(e))}c=a.H;a.C.Yf(0==a.D?c:c+b+1);yq(a.C.Qa,"label","Headers")}p.hIb=function(){var a=this.fb("waffle-range-selection-input");this.F!=a.value&&(this.F=a.value,lBc(this))};p.ZNb=function(){var a=this.L.bb();this.F=a;var b=this.fb("waffle-range-selection-input");b.value=a;b.select();lBc(this)};
p.XNb=function(a){var b=this.fb("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.F=b.value;lBc(this);R.GZ.Dc();break;case 27:a.stopPropagation(),a.preventDefault(),iBc(this),R.sR.Dc()}};p.YNb=function(){this.F=this.fb("waffle-range-selection-input").value;lBc(this)};p.bxb=function(){var a=this.C.Oh(),b=nBc(this.getTableRange(),0);this.Cfa(this.getTableRange(),a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};function rZ(a,b,c,d){pu.call(this,a,b,c,d,void 0,void 0,!0)}u(rZ,pu);rZ.prototype.Ka=function(){rZ.ea.Ka.call(this);T(this.Qa,"waffle-assistant-toast");T(this.fb("docs-ui-toast-content"),"waffle-assistant-toast-content")};rZ.prototype.dC=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=wp(this,b);rZ.ea.dC.call(this,a,b,c)};rZ.prototype.Sh=function(a,b,c,d){this.dC(a,b,d);a=yp(this,b);this.getHandler().$h(a,ed,t(function(){this.setVisible(!1);c()},this))};function oBc(){this.C=null}u(oBc,D);oBc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function cZ(a,b,c,d){a.clear();a.C=new rZ(b,c,!1,5E3);a.C.render();d&&a.C.Sh("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}oBc.prototype.Oa=function(){oBc.ea.Oa.call(this);this.clear()};function FAc(a){a=a||{};var b=W,c=Qr('<div class="waffle-assistant-replaceable-title">'+pBc()+"</div>");var d=d=a||{};var e=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+V(Cxc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');e=d.sP?e+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
e+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";d=W(e+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');d=W(""+('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
d+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return b(V(iW(Or({title:c,Il:Qr(""+d),id:Pr("autovis"),tP:Pr("waffle-assistant-sidepanel"),dga:Pr("waffle-assistant-title"),X_:Pr("waffle-assistant-sidepane-content")},a))))}
function pBc(){return W('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+V(Cxc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+V("Explore")+"</div></div>")};function sZ(a,b,c,d,e,f,h,k,l,m){mZ.call(this,a,b,c,d,e,m);this.uf=f;this.Gb=b;this.eb=new P(this.Da());this.Ya(this.eb);this.va=new oBc;this.Ea(this.va);this.D=[];this.F=null;this.Cb=new bt("",m,4);Gr(this.Cb,2,!1);this.Ya(this.Cb);this.Ed=h;this.If=k;this.Bd=l;this.$=null;this.Ia=0;this.La=null;this.$b=new Us("",new yY,this.Da());this.Ya(this.$b);this.kc=new P(this.Da());this.Ya(this.kc);this.Yc=(new SN).build();this.Ea(this.Yc);Nu(this.Yc,this.$b,R.k8);this.V=this.H=null;this.Za=[]}u(sZ,mZ);
var tZ={tF:"waffle-assistant-scroll-pane-feature-content",Vec:"waffle-assistant-empty-list",i3a:"waffle-assistant-features",k4a:"waffle-assistant-empty-list-learn-more",Gia:"waffle-assistant-expanded-panel",ACa:"waffle-assistant-replaceable-title",R5a:"waffle-assistant-scroll-pane",C6a:"waffle-assistant-sidepane-tables-range",D6a:"waffle-sidebar-tables-bar",PDa:"waffle-assistant-tables-scroll-pane",E6a:"waffle-assistant-tables-edit-range-button",tR:"waffle-assistant-title"},qBc={defaultHelpArticleId:"6280499"};
p=sZ.prototype;
p.Ua=function(){var a=this;sZ.ea.Ua.call(this);this.eb.rb(this.fb(tZ.Gia));zY(this.C.Qa,"Close");Zn&&(this.kc.rb(this.fb(tZ.C6a)),KAc(this),this.$b.rb(this.fb(tZ.E6a)));var b=this.Gb.L.fw();Sn&&(uva||"en"==xw(b))&&(b=new iZ(this.uf,this.Qb,this.Zd,this.jg,this.ct(),this.va,this.Gb,this.If,this.Bd,this.Da()),this.Ya(b),this.D.push(b));b=new ZAc(this.ct(),this.va,this.Da());this.Ya(b);this.D.push(b);Sh(I(),"fedvs")&&(b=new QAc(this.ct(),this.va,this.Da()),this.Ya(b),this.D.push(b));b=new IY(this.Zd,
this.Qb,this.ct(),this.va,this.Da());this.Ya(b);this.D.push(b);var c=this.fb(tZ.i3a);x(this.D,function(b){b.render(c);a.eb.Ya(b.C,!0)});this.Cb.rb(this.fb(tZ.k4a));this.getHandler().R(this.Cb,"action",this.N4b).R(this,"He",this.i9).R(this,"Ge",this.O4b);rBc(this)};p.O4b=function(){var a=sBc(this);a&&(a.Ia=!0)};p.N4b=function(){Q.Uo.Dc(qBc)};function MAc(a){x(a.D,function(a){Lxc(a)})}function IAc(a,b,c,d){x(a.D,function(a){a.qX(b,c,d)})}function JAc(a){return!!wb(a.D,function(a){return a.Ura()})}
p.Pga=function(){var a=this,b=this.fb("waffle-assistant-scroll-pane").scrollTop+ip(this.fb("waffle-assistant-sidepane-content")).height;x(this.D,function(c){a.F&&a.F!=c||(c instanceof IY&&a.getHandler().Mc(c,"Ce",a.ANb),b=c.e6(b))})};function HAc(a){if(a.F)return a.F.C.C;var b=[];x(a.D,function(a){Lb(b,Kxc(a))});return b}p.ef=function(a){sZ.ea.ef.call(this,a);rBc(this)};p.eg=function(a){x(this.D,function(b){b.eg(a)})};p.Kva=function(){var a=this.fb(tZ.ACa),b=this.fb(tZ.tR);hp(b,ip(a).height)};
p.Hc=function(){var a=this,b=this.fb(tZ.tF),c=this.fb(tZ.ACa),d=this.eb.Qa;if(this.F)this.F.C.setVisible(!1),this.F.setActive(!1),this.F=null,N(b,!0),N(d,!1),mr(c,pBc),zq(c,"label"),this.resize();else if(this.F=wb(this.D,function(a){return a.gc()}))N(b,!1),N(d,!0),this.F.C.setVisible(!0),Mxc(this.F,c),Bq(c,this.F.rX());this.Kva();b=new jl(function(){var b=Gv;b&&b.dispatchEvent("resize");a.Pga()},300);this.Ea(b);b.start()};
p.setVisible=function(a){var b=this.pb();sZ.ea.setVisible.call(this,a);a&&!b&&tBc(this,!0);a||this.va.clear()};p.Ira=function(){sZ.ea.Ira.call(this);this.F&&this.Hc();this.i9()};p.tra=function(){sZ.ea.tra.call(this);tBc(this,!0)};p.sra=function(){sZ.ea.sra.call(this);tBc(this,!1)};p.Jqa=function(a){sZ.ea.Jqa.call(this,a);tBc(this,!0,a.F)};p.Iqa=function(a){sZ.ea.Iqa.call(this,a);tBc(this,!1)};
function uBc(a,b){if(Zn){var c=sBc(a);b?(M1b(a.H),a.H=new gBc(a.Gb,a.Qb,a.Ed,a.$,a.Ia,a.La,a.ct(),a.Bd,!!c&&c.gc()),a.Ya(a.H),a.H.render(a.getElement())):a.H&&(a.removeChild(a.H,!0),F(a.H),a.H=null);c&&rAc(c,b)}}function LAc(a,b){if(Zn&&1!=a.La){var c=sBc(a);b?(a.V=new qZ(a.Gb,a.Qb,a.Ed,a.$,a.Ia,a.La,!!c&&c.gc()),a.Ya(a.V),a.V.render(a.getElement())):a.V&&(a.removeChild(a.V,!0),F(a.V),a.V=null);c&&rAc(c,b)}}function rBc(a){x(a.D,function(b){b.ef(a.Hd())})}
function sBc(a){return(a=wb(a.D,function(a){return a instanceof iZ}))?a:null}function tBc(a,b,c){x(a.D,function(a){c||Gxc(a.C,b)});Zn&&b&&(a.$=null,a.Ia=0,a.La=null,a.i9(),KAc(a))}function KAc(a){var b=a.fb(tZ.D6a),c=a.fb(tZ.R5a);if(a.$){var d=ih(a.$);d=nx(d);d=U(eBc,{mJ:d});a=a.kc.Zb();dn(a);a.appendChild(d);N(b,!0);T(c,tZ.PDa)}else N(b,!1),rq(c,tZ.PDa)}p.i9=function(){uBc(this,!1);LAc(this,!1)};function uZ(a,b,c,d,e,f,h,k,l,m,r,v){var w=this;dW.call(this,b,h);this.$=a;this.C=b;this.O=c;this.Za=d;this.ob=e;this.L=f;this.H=c.C;this.eb=this.Sa=!1;this.F=null;this.Mb=l;this.kb=v;this.ad=new ch;this.J=null;vBc(this);R.t6.hb(!0);a=new bj;M(a,6,wBc());b=new $i;Ti(b,58,a);this.va=ij(jj(new hj,b),10).build();this.gb=Zh();this.La=$h(this.gb,gk.EAa);this.Ia=-1;a=new jl(function(){return xBc(w,!1)},100);this.Ea(a);a.start()}u(uZ,dW);
function vBc(a){var b=Lw(a.ob);a.Ef().R(a.Za,"selectionChange",a.R4b).R(a.H,"M",a.P4b).R(b,"ga",a.nAb).R(a.C,"ze",a.hpb).R(a.C,"ye",a.gpb).R(a.C,"xe",a.epb).R(a.C,"Ee",a.FEb).R(a.C,"Be",a.zqb).R(a.C,"De",a.Q4b).R(a.C,"Ie",a.wHb).R(a.C,"Fe",a.bGb).R(a.C,"Ae",a.Gpb).R(a.C,"Je",a.T4b).R(a.$.C,"recommender-confidence-update",a.bsb).R(a.C,"Ge",a.S4b);Rp(a.V,R.WP,Mp,a.iyb).subscribe(R.XP,"action",a.Dpb).subscribe(R.u6,"action",a.eHb).subscribe(R.gha,"action",a.eVa).subscribe(R.dx,"action",a.VBb).subscribe(R.k8,
"action",a.sHb)}p=uZ.prototype;p.Wh=function(){return R.hha};p.Ku=function(){return R.rza};p.Br=function(a){uZ.ea.Br.call(this,a);R.u6.hb(a);xBc(this,!1);!this.Sa&&a&&(this.Sa=!0);mq(this.kb,{Ob:a})};p.G2=function(a){var b=this;this.C.Kva();var c=new jl(function(){uZ.ea.G2.call(b,a)},300);this.Ea(c);c.start()};p.Oqa=function(){uZ.ea.Oqa.call(this);yBc(this,!1)};p.eg=function(a){this.C.eg(a);this.$.eg(a)};
p.hpb=function(a){var b=a.C.D,c=B(B(b,13),3);b=fV(b);var d=new mf;C(d,1,c);c=new nf;C(c,1,d);C(c,3,!0);C(c,4,!0);this.L.C(new iX(c,b));vZ(this,a.Aj())};p.Dpb=function(){var a=this.C.pb();this.Wh().setVisible(!a);a||this.C.focus();yBc(this,!a)};function yBc(a,b){b?(vZ(a,2253),a.Ia=Ha()):vZ(a,2226,!0)}p.eVa=function(){this.C.pb()||this.Br(!0)};p.VBb=function(){var a=sBc(this.C);a&&!a.gc()&&(this.eVa(),tAc(a,"",!0))};p.eHb=function(a){GAc(this.C,a)};p.sHb=function(){uBc(this.C,!0)};
p.R4b=function(){Nw(this.O)&&!this.C.H&&xBc(this,!0)};function xBc(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.J&&c[0].equals(a.J)){a.J=null;return}}var d=a.C;d.pb()&&(xAc(d.gb),nZ(d));a.$.update(!b,a.C.pb(),c)}
p.bsb=function(a){""!=this.La&&(ai(this.gb,this.La),this.La="");var b=a.F||0;a=a.C;var c=!!a&&a.rect,d=(c=!!c&&c.Nh()>=ova&&ue(c,"r")>=qva&&ue(c,"c")>=rva&&c.Nh()<=pva)&&.6<=b;if(d!==this.eb||a&&!a.equals(this.F))this.eb=d,this.F=a,this.Ia=Ha(),R.t6.Dc({Vca:d,mJ:a});c&&a&&a.rect&&(c=.9<=b,d=1E3>=a.rect.Nh(),a=ritz_api.RitzModelApi.isFormsRegion(""+a.Zc,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),c=!this.C.pb()&&!this.Sa&&c&&d&&!Fw(this.O),a=fva&&a,d=gva&&this.O.Hd(),
c&&(a||d)&&(c=new bj,M(c,1,b),M(c,2,a),M(c,3,d),M(c,5,vva),M(c,6,wBc()),b=new $i,Ti(b,58,c),b=jj(ij(new hj,10),b).build(),this.iFa(b)))};p.iFa=function(a){var b=this;this.C.Ac=!0;var c=SZa(Bw(this.H));if(!t_b.C&&!c){var d=a||this.va;this.Wh().setVisible(!0);this.Mb.mc(2225,d);vZ(this,2253);a=new jl(function(){b.C.pb()||b.Mb.mc(2752,d)},5E3);this.Ea(a);a.start()}};
function wBc(){switch(sva){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}p.Gpb=function(){this.C.Hc()};p.T4b=function(a){var b=a.C,c=fV(b.D),d=parseInt(c.Pb(),10);this.J=ih(c);this.L.C(new k0b(d));WAc(b,c);vZ(this,a.Aj())};p.P4b=function(){Uw(this.H)?(this.C.hb(!0),xBc(this,!1)):(this.Wh().setVisible(!1),this.C.hb(!1))};p.iyb=function(){this.C.ef(!R.WP.isEnabled())};p.nAb=function(a){xBc(this,!1,fMa(a))};
p.gpb=function(a){var b=Bw(this.H),c=""+b.Bc(),d=[],e=foc(b);if(e){b=new hg;var f=Bc(e,2);C(b,3,f);f=Bc(e,2);C(b,2,f);e=Bc(e,1);C(b,1,e);d.push(b)}b=a.C.Cb;for(e=0;e<b.length;e++)f=new hg,C(f,2,b[e]),d.push(f);this.L.C(new aX(d,c));vZ(this,a.Aj())};
p.epb=function(a){var b=a.C,c=$oc(b.C),d=fV(b.D),e=c.wv?c.iy:null,f=c.C?c.Kx:null,h=parseInt(d.Pb(),10),k=zBc(d);this.J=ih(d);k?this.L.C(new bW(k,h,this.J,e,c.Xs,c.St,f)):this.L.C(new $V(h,this.J,e,c.Xs,c.St,f));d=new xoc;M(d,1,1);c=new jV;b=B(b.D,2);M(c,2,b);Ti(c,5,d);b=lxc(this.F);Ti(b,46,c);b=jj(ij(new hj,10),b).build();this.Mb.C(a.Aj(),b)};p.FEb=function(a){a=a.C;var b=fV(a.D),c=parseInt(b.Pb(),10),d=zBc(b);this.J=ih(b);this.L.C(new aW(d,c));WAc(a,b)};
p.S4b=function(a){var b=Bw(this.O.C),c=b.Bc();b=gh(SMa(a.L,b),c);c=jxc(b,a.F,a.V);var d=this.$,e=a.F;HLa(d.C);d.C.Za=b;d.C.La=c;d.C.Sa=e;RLa(d.C,!0,!0);vZ(this,a.Aj())};function zBc(a){var b=a.Pb();a=ih(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.yc(),a.wc(),a.Pc(),a.Uc(),7,!1);return 0<b.length?b[0]:null}p.zqb=function(a){WC(Bw(this.H),a.J);vZ(this,a.Aj())};
p.wHb=function(a){var b=a.C;a=a.Aj();if(b instanceof bZ||b instanceof fZ)vZ(this,a);else{var c=HAc(this.C),d=new jV,e=B(b.D,2);c=c.indexOf(b);M(d,1,c);M(d,2,e);e=new $i;Ti(e,46,d);if(b instanceof DY){(d=b.H)?(b=ABc(this,b,d),b=Xrc(b,d,d.mf())):b=null;if(!b)return;Ti(e,39,b)}else if(b instanceof FY){var f=b.D;c=new uwc;if(b instanceof FY)b=1;else throw Error("Unknown text analysis card type.");f=Ac(B(f,8),20).slice(0,10);M(c,2,f||[]);M(c,1,b);Ti(d,3,c)}e=jj(ij(new hj,10),e).build();this.Mb.C(a,e)}};
p.bGb=function(){this.C.Hc()};
p.Q4b=function(a){var b=a.L;if(b){var c=Bw(this.H),d=a.Xe();d||(d=mA(this.Za).od().C.Xe());var e=16,f=16,h=a.eb;h&&(e=h.x,f=h.y);h=fnc(this.O.J);d={oid:null,ar:cD(c,d.y),ac:dD(c,d.x),x:e,y:f,h:mD.height,w:mD.width,p:{context:{chartName:"Chart "+(h+1)}}};(c=b.mf())?(e=new Tl(c),d=new sF(Aw(this.H)||0,d,!1,!1),f=cm(e,"headers"),f=null!=f&&na(f)&&Sa(f)?parseInt(f,10):-1,d.kb=f,d.$=0,f="1"==cm(e,"transpose"),d.eb=f,d.L=f?"ROWS":"COLS",f=cm(e,"range"),f=joc(BV(f,","),this.H),d.dJ(f),(e=cm(e,"dt"))&&P5a(d,
this.ad.Qc(ug.Ra(),JSON.parse(decodeURIComponent(e))))):(e=new Cg,C(e,2,"0.6"),f=a.Gd().toJSON(),C(e,1,f),d=new sF(Aw(this.H)||0,d,!1,!1,e));cV(d,b);this.Za.dispatchEvent(new IF("objectRequest"));this.L.C(new UH(this.O,d));e=BBc(this,b,a.V,a.Gd());e.cl(d.getId()||0);WW(this.Mb,a.Aj(),e,10,b,c,void 0,a.F)}};function ABc(a,b,c){var d=HAc(a.C).filter(function(a){return a instanceof DY});return BBc(a,c,d.indexOf(b),b.H&&b.H.Gd())}
function BBc(a,b,c,d){var e=new VW;a=HAc(a.C).filter(function(a){return a instanceof DY}).map(function(a){return a.getChartType()});e.O=a;e.H=c;Urc(e,b.getChartType());e.F=d?d.clone():null;return e}
function vZ(a,b,c){if(a.F){var d=Ri(kma(a.va),bj,58).getTableRange();if(c||!d||d.Pb()!=a.F.Zc||d.wc()!=a.F.rect.wc()||d.yc()!=a.F.rect.yc()||d.Uc()!=a.F.rect.Uc()||d.Pc()!=a.F.rect.Pc()){d=new bj;M(d,6,wBc());var e=kxc(a.F);Ti(d,7,e);c&&(c=Ha()-a.Ia,M(d,8,1E3*c));c=new $i;Ti(c,58,d);a.va=ij(jj(new hj,c),10).build()}}a.Mb.mc(b,a.va)};function CBc(){D.call(this)}u(CBc,ho);CBc.prototype.C=function(){return uAc};CBc.prototype.F=function(){return sZ};CBc.prototype.D=function(){return uZ};Ao("assistant",CBc);
